{"ast":null,"code":"import _objectSpread from\"D:/DigiFloat/LawChronicle/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{Scissors,Database,FileText,Settings,History,Eye,RotateCcw,Split,Layers,Loader2,AlertCircle}from'lucide-react';// Configuration interface - updated to match CLI flow\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";// Default configuration - matches CLI scripts\nconst DEFAULT_CONFIG={source_database:\"Statutes\",source_collection:\"normalized_statutes\",target_database:\"Batched-Statutes\",target_collection_prefix:\"batch_\",batch_size:10,enable_ai_cleaning:false};const Phase3=()=>{var _status$collection_st,_status$collection_st2,_status$collection_st3,_status$collection_st4,_validationResults$me,_validationResults$me2,_validationResults$me3,_validationResults$me4,_validationResults$me5,_statistics$statistic,_statistics$statistic2,_statistics$statistic3,_statistics$statistic4,_statistics$statistic5,_statistics$statistic6,_statistics$statistic7,_statistics$statistic8,_statistics$statistic9,_statistics$statistic0,_statistics$statistic1,_statistics$statistic10,_statistics$statistic11,_statistics$statistic12,_statistics$statistic13;const[activeTab,setActiveTab]=useState('overview');const[config,setConfig]=useState(DEFAULT_CONFIG);const[isProcessing,setIsProcessing]=useState(false);const[status,setStatus]=useState(null);const[statistics,setStatistics]=useState(null);const[batchPreview,setBatchPreview]=useState(null);const[progressStep,setProgressStep]=useState('');const[progressDetails,setProgressDetails]=useState('');const[processingStats,setProcessingStats]=useState(null);const[operationError,setOperationError]=useState(null);const[prefixError,setPrefixError]=useState(null);const[history,setHistory]=useState(null);const[availableBatches,setAvailableBatches]=useState(null);const[diagnostics,setDiagnostics]=useState(null);const[selectedBatches,setSelectedBatches]=useState([]);const[cleanAllBatches,setCleanAllBatches]=useState(true);const[dryRun,setDryRun]=useState(true);const[validationResults,setValidationResults]=useState(null);const[saveMetadata,setSaveMetadata]=useState(true);const[expandedStatutes,setExpandedStatutes]=useState({});const[expandedSections,setExpandedSections]=useState({});// Load config from localStorage on mount\nuseEffect(()=>{const savedConfig=localStorage.getItem('phase3_config');if(savedConfig){try{setConfig(JSON.parse(savedConfig));}catch(error){console.error('Error loading Phase 3 config:',error);}}},[]);// Save config to localStorage when it changes\nuseEffect(()=>{localStorage.setItem('phase3_config',JSON.stringify(config));},[config]);// Update configuration\nconst updateConfig=updates=>{const newConfig=_objectSpread(_objectSpread({},config),updates);setConfig(newConfig);// Validate prefix\nif('target_collection_prefix'in updates){const v=updates.target_collection_prefix;validatePrefix(v);}};const validatePrefix=prefix=>{if(!prefix||!prefix.trim()){setPrefixError('Prefix cannot be empty');return false;}const ok=/^[A-Za-z0-9_-]{1,50}$/.test(prefix.trim());if(!ok){setPrefixError('Use only letters, numbers, underscore or hyphen (1-50 chars)');return false;}if(prefix.trim().startsWith('$')||prefix.trim().toLowerCase().startsWith('system')){setPrefixError('Prefix cannot start with \"$\" or \"system\"');return false;}setPrefixError(null);return true;};// Reset configuration to defaults\nconst resetConfig=()=>{setConfig(DEFAULT_CONFIG);};// Fetch Phase 3 status\nconst fetchStatus=async()=>{try{const response=await fetch('/api/v1/phase3/status');if(response.ok){const data=await response.json();setStatus(data);}}catch(error){console.error('Error fetching Phase 3 status:',error);}};// Refresh status and related data; when on Pakistan tab also refresh available batches\nconst refreshStatus=async()=>{await fetchStatus();// If user is on Pakistan validation tab, refresh batch listings so document counts update\nif(activeTab==='pakistan-law-validation'){await fetchAvailableBatches();}// If on statistics tab refresh stats as well\nif(activeTab==='statistics'){await fetchStatistics();}};// Fetch statistics\nconst fetchStatistics=async()=>{try{const response=await fetch('/api/v1/phase3/statistics',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(config)});if(response.ok){const data=await response.json();setStatistics(data);}}catch(error){console.error('Error fetching Phase 3 statistics:',error);}};// Fetch batch preview\nconst fetchBatchPreview=async()=>{try{const response=await fetch('/api/v1/phase3/preview-batches',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(config)});if(response.ok){const data=await response.json();setBatchPreview(data);}}catch(error){console.error('Error fetching batch preview:',error);}};// Fetch history\nconst fetchHistory=async()=>{try{const response=await fetch('/api/v1/phase3/history');if(response.ok){const data=await response.json();setHistory(data);}}catch(error){console.error('Error fetching history:',error);}};// Fetch available batches for cleaning\nconst fetchAvailableBatches=async()=>{try{const response=await fetch('/api/v1/phase3/available-batches',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(config)});if(response.ok){const data=await response.json();setAvailableBatches(data);}}catch(error){console.error('Error fetching available batches:',error);}};// Generate metadata\nconst generateMetadata=async()=>{try{const response=await fetch('/api/v1/phase3/generate-metadata',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(config)});if(response.ok){const result=await response.json();alert(\"Metadata generated successfully! File: \".concat(result.metadata_file));fetchHistory();}else{const error=await response.json();alert(\"Error generating metadata: \".concat(error.detail));}}catch(error){console.error('Error generating metadata:',error);alert('Failed to generate metadata');}};// Start section splitting using modern service endpoint\nconst startSectionSplitting=async()=>{setIsProcessing(true);setOperationError(null);setProgressStep('Initializing section splitting process...');setProgressDetails('Preparing to analyze and split statute sections');setProcessingStats(null);try{// Step 1: Prepare request\nsetProgressStep('Preparing section splitting request');setProgressDetails(\"Source: \".concat(config.source_database,\".\").concat(config.source_collection,\" \\u2192 Target: \").concat(config.target_database,\".\").concat(config.target_collection_prefix,\"*\"));// Step 2: Send to the correct endpoint\nsetProgressStep('Connecting to section splitting service');setProgressDetails('Analyzing statute structure and splitting into batches...');const response=await fetch('/api/v1/phase3/start-section-splitting',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(config)});// Step 3: Process results\nsetProgressStep('Processing section splitting results');setProgressDetails('Analyzing split sections and organizing data...');if(response.ok){const result=await response.json();setProgressStep('Section splitting completed successfully!');setProgressDetails(\"Successfully created \".concat(result.batches_created||0,\" batch collections\"));// Show success notification with details\nconst batchCount=result.batches_created||0;setProcessingStats({processed:batchCount,total:batchCount,operation:'Section Splitting'});fetchStatus();// Clear progress after delay\nsetTimeout(()=>{setProgressStep('');setProgressDetails('');setProcessingStats(null);},3000);}else{const error=await response.json();throw new Error(error.detail||'Section splitting failed');}}catch(error){setProgressStep('Error during section splitting');const errorMessage=error instanceof Error?error.message:'Failed to start section splitting';setProgressDetails(errorMessage);setOperationError(errorMessage);}finally{setIsProcessing(false);}};// Start field cleaning using modern service endpoint\nconst startFieldCleaning=async()=>{setIsProcessing(true);setOperationError(null);setProgressStep('Initializing field cleaning process...');setProgressDetails('Preparing to clean and validate field data');setProcessingStats(null);try{// Step 1: Prepare cleaning request (send the Phase3 config)\nsetProgressStep('Preparing field cleaning request');setProgressDetails(\"Scheduling cleaning for collections with prefix: \".concat(config.target_collection_prefix));// Step 2: Schedule cleaning on the backend (background task)\nsetProgressStep('Scheduling field cleaning on server');setProgressDetails('Requesting server to start field cleaning in background...');const response=await fetch('/api/v1/phase3/start-field-cleaning',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(config)});// Step 3: Process cleaning results\nsetProgressStep('Processing field cleaning results');setProgressDetails('Validating cleaned data and updating collections...');if(response.ok){const result=await response.json();const batches=result.batches_scheduled||[];setProgressStep('Field cleaning scheduled');setProgressDetails(\"Cleaning scheduled for \".concat(batches.length,\" batches. Server is processing in background.\"));setProcessingStats({processed:batches.length,total:batches.length||1,operation:'Field Cleaning'});fetchStatus();// Refresh available batches so cleaned flags update immediately\nfetchAvailableBatches();fetchHistory();// refresh history to show new metadata\n// Clear progress after short delay but keep status visible\nsetTimeout(()=>{setProgressStep('');setProgressDetails('');},3000);}else{const error=await response.json();throw new Error(error.detail||'Field cleaning scheduling failed');}}catch(error){setProgressStep('Error during field cleaning');const errorMessage=error instanceof Error?error.message:'Failed to start field cleaning';setProgressDetails(errorMessage);setOperationError(errorMessage);}finally{setIsProcessing(false);}};// Start batch cleaning (using service architecture)\nconst startBatchCleaning=async()=>{setIsProcessing(true);try{// Build payload matching the backend BatchCleaningConfig model\nconst payload={target_database:config.target_database,target_collection_prefix:config.target_collection_prefix,batch_numbers:cleanAllBatches?null:selectedBatches,clean_all:cleanAllBatches};// Call the dedicated endpoint that schedules cleaning for selected batches\nconst response=await fetch('/api/v1/phase3/clean-batches',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});if(response.ok){const result=await response.json();alert('Batch cleaning started successfully!');// Refresh status and batches so UI reflects scheduled cleaning\nrefreshStatus();fetchHistory();}else{const error=await response.json();alert(\"Error starting batch cleaning: \".concat(error.detail||error.message||'Unknown error'));}}catch(error){console.error('Error starting batch cleaning:',error);alert('Failed to start batch cleaning');}finally{setIsProcessing(false);}};// Start Pakistan Law Validation\nconst startPakistanLawValidation=async()=>{setIsProcessing(true);setValidationResults(null);try{const payload={target_database:config.target_database,target_collection_prefix:config.target_collection_prefix,batch_numbers:cleanAllBatches?null:selectedBatches,clean_all:cleanAllBatches};const url=\"/api/v1/phase3/validate-pakistan-batches?dry_run=\".concat(dryRun,\"&save_metadata=\").concat(saveMetadata);const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});if(response.ok){const result=await response.json();setValidationResults(result);fetchStatus();fetchHistory();}else{const err=await response.json();alert(\"Error during validation: \".concat(err.message||err.detail));}}catch(error){console.error('Error validating Pakistan law batches:',error);alert('Pakistan law validation failed');}finally{setIsProcessing(false);}};// Preview validation metadata\nconst previewValidationMetadata=async()=>{setIsProcessing(true);try{const payload={target_database:config.target_database,target_collection_prefix:config.target_collection_prefix,batch_numbers:cleanAllBatches?null:selectedBatches,clean_all:cleanAllBatches};const response=await fetch('/api/v1/phase3/preview-validation-metadata',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});if(response.ok){const result=await response.json();alert(\"Metadata Preview:\\n\\nEstimated Documents: \".concat(result.estimated_documents,\"\\nBatches: \").concat(result.batches_to_process.length,\"\\n\\nMetadata structure generated successfully!\"));}else{const err=await response.json();alert(\"Error previewing metadata: \".concat(err.message||err.detail));}}catch(error){console.error('Error previewing validation metadata:',error);alert('Metadata preview failed');}finally{setIsProcessing(false);}};// Handle batch selection\nconst toggleBatchSelection=batchNumber=>{setSelectedBatches(prev=>prev.includes(batchNumber)?prev.filter(n=>n!==batchNumber):[...prev,batchNumber]);};// Toggle statute expansion\nconst toggleStatuteExpansion=statuteKey=>{setExpandedStatutes(prev=>_objectSpread(_objectSpread({},prev),{},{[statuteKey]:!prev[statuteKey]}));};// Toggle section expansion\nconst toggleSectionExpansion=sectionKey=>{setExpandedSections(prev=>_objectSpread(_objectSpread({},prev),{},{[sectionKey]:!prev[sectionKey]}));};// Rollback Phase 3\nconst rollbackPhase3=async()=>{if(!window.confirm('Are you sure you want to rollback Phase 3? This will delete all created batch collections and databases.')){return;}try{const response=await fetch('/api/v1/phase3/rollback',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(config)});if(response.ok){const result=await response.json();alert('Phase 3 rollback completed successfully!');fetchStatus();fetchStatistics();}else{const error=await response.json();alert(\"Error rolling back Phase 3: \".concat(error.detail));}}catch(error){console.error('Error rolling back Phase 3:',error);alert('Failed to rollback Phase 3');}};// Load data on mount\nuseEffect(()=>{fetchStatus();fetchStatistics();},[]);// Auto-load batches when Pakistan Law Validation tab is active\nuseEffect(()=>{if(activeTab==='pakistan-law-validation'){fetchAvailableBatches();}},[activeTab]);const tabs=[{id:'overview',name:'Overview',icon:Database},{id:'section-splitting',name:'Section Splitting',icon:Split},{id:'field-cleaning',name:'Field Cleaning',icon:Scissors},{id:'pakistan-law-validation',name:'Pakistan Law Validation',icon:FileText},{id:'preview',name:'Batch Preview',icon:Eye},{id:'statistics',name:'Statistics',icon:Settings},{id:'history',name:'History',icon:History}];// Start Pakistan Law Validation (mirrors batch cleaning, but uses different processing_type)\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-0\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm border border-gray-200 p-2\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl font-bold text-gray-900 mb-1\",children:\"Phase 3: Field Cleaning & Splitting\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 text-sm\",children:\"Split normalized statutes into batches, then clean each batch using CLI logic\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm border border-gray-200 p-2 mt-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-2\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-gray-900\",children:\"Current Configuration\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:resetConfig,className:\"inline-flex items-center px-3 py-1 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\",children:[/*#__PURE__*/_jsx(RotateCcw,{className:\"h-4 w-4 mr-1\"}),\"Reset to Defaults\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-700\",children:\"Source DB:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:config.source_database,onChange:e=>updateConfig({source_database:e.target.value}),className:\"ml-2 px-2 py-1 border border-gray-300 rounded text-xs w-full\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-700\",children:\"Source Collection:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:config.source_collection,onChange:e=>updateConfig({source_collection:e.target.value}),className:\"ml-2 px-2 py-1 border border-gray-300 rounded text-xs w-full\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-700\",children:\"Target DB:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:config.target_database,onChange:e=>updateConfig({target_database:e.target.value}),className:\"ml-2 px-2 py-1 border border-gray-300 rounded text-xs w-full\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-700\",children:\"Batch Prefix:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:config.target_collection_prefix,onChange:e=>updateConfig({target_collection_prefix:e.target.value}),className:\"ml-2 px-2 py-1 border border-gray-300 rounded text-xs w-full\"}),prefixError&&/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-red-600 mt-1\",children:prefixError})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-gray-700\",children:\"Number of Batches:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:config.batch_size,onChange:e=>updateConfig({batch_size:parseInt(e.target.value)||10}),className:\"ml-2 px-2 py-1 border border-gray-300 rounded text-xs w-16\",min:\"1\",max:\"50\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg shadow-sm border border-gray-200 mt-2\",children:/*#__PURE__*/_jsx(\"nav\",{className:\"flex space-x-8 px-4\",\"aria-label\":\"Tabs\",children:tabs.map(tab=>{const Icon=tab.icon;return/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setActiveTab(tab.id),className:\"py-3 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 \".concat(activeTab===tab.id?'border-purple-500 text-purple-600':'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'),children:[/*#__PURE__*/_jsx(Icon,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsx(\"span\",{children:tab.name})]},tab.id);})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mt-2\",children:[activeTab==='overview'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-blue-50 p-4 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold text-blue-900 mb-2 flex items-center\",children:[/*#__PURE__*/_jsx(Split,{className:\"h-5 w-5 mr-2\"}),\"Section Splitting\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-blue-700 text-sm mb-3\",children:[\"Split normalized statutes from \",config.source_database,\".\",config.source_collection,\" into \",config.batch_size,\" equal batches in \",config.target_database,\".\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:startSectionSplitting,disabled:isProcessing,className:\"w-full bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\",children:isProcessing?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Loader2,{className:\"w-4 h-4 mr-2 inline animate-spin\"}),progressStep||'Processing...']}):'Start Section Splitting'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-green-50 p-4 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold text-green-900 mb-2 flex items-center\",children:[/*#__PURE__*/_jsx(Scissors,{className:\"h-5 w-5 mr-2\"}),\"Field Cleaning\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-green-700 text-sm mb-3\",children:\"Clean each batch using CLI logic: drop unnecessary fields, bring common fields up, handle single sections, remove duplicates, and sort sections.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:startFieldCleaning,disabled:isProcessing||!!prefixError,className:\"w-full bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed\",children:isProcessing?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Loader2,{className:\"w-4 h-4 mr-2 inline animate-spin\"}),progressStep||'Processing...']}):'Start Field Cleaning'})]})]}),isProcessing&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-6 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900\",children:\"Processing Status\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(Loader2,{className:\"w-5 h-5 text-blue-600 animate-spin mr-2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium text-blue-700\",children:\"In Progress\"})]})]}),progressStep&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-base font-medium text-gray-800 mb-1\",children:progressStep}),progressDetails&&/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:progressDetails})]}),processingStats&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg p-4 border border-gray-200\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium text-gray-700\",children:processingStats.operation}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-gray-600\",children:[processingStats.processed.toLocaleString(),\" processed\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-gray-200 rounded-full h-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-r from-blue-500 to-purple-600 h-3 rounded-full transition-all duration-500 ease-out\",style:{width:\"\".concat(processingStats.processed/processingStats.total*100,\"%\")}})})]})]}),operationError&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-50 border border-red-200 rounded-lg p-6 mb-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start\",children:[/*#__PURE__*/_jsx(AlertCircle,{className:\"w-5 h-5 text-red-600 mr-3 mt-0.5\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-base font-medium text-red-900 mb-2\",children:\"Operation Failed\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-red-800 mb-3\",children:operationError}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-red-600\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Troubleshooting Steps:\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"mt-2 ml-4 list-disc space-y-1\",children:[/*#__PURE__*/_jsx(\"li\",{children:\"Verify database connection is active\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Check that source collections contain data\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Ensure sufficient permissions for target database\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Review configuration settings for accuracy\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Try refreshing the page and attempting the operation again\"})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setOperationError(null),className:\"mt-3 text-sm text-red-600 hover:text-red-800 underline\",children:\"Dismiss error\"})]})]})}),status&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 p-4 rounded-lg\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-3\",children:\"Current Status\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-blue-600\",children:(_status$collection_st=status.collection_status)!==null&&_status$collection_st!==void 0&&_status$collection_st.source_exists?'✅':'❌'}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:\"Source Collection\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500\",children:[config.source_database,\".\",config.source_collection]}),((_status$collection_st2=status.collection_status)===null||_status$collection_st2===void 0?void 0:_status$collection_st2.source_count)>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500\",children:[status.collection_status.source_count,\" documents\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-green-600\",children:(_status$collection_st3=status.collection_status)!==null&&_status$collection_st3!==void 0&&_status$collection_st3.target_database_exists?'✅':'❌'}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:\"Target Database\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500\",children:config.target_database})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-purple-600\",children:((_status$collection_st4=status.collection_status)===null||_status$collection_st4===void 0?void 0:_status$collection_st4.batch_count)||0}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-600\",children:\"Batch Collections\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500\",children:[config.target_collection_prefix,\"1, \",config.target_collection_prefix,\"2, ...\"]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-red-50 p-4 rounded-lg\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-red-900 mb-2\",children:\"Rollback\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-red-700 text-sm mb-3\",children:\"Rollback Phase 3 changes and restore previous state if needed.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:rollbackPhase3,className:\"w-full bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700\",children:\"Rollback Phase 3\"})]})]}),activeTab==='section-splitting'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900\",children:\"Section Splitting Configuration\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-blue-50 p-4 rounded-lg\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-blue-900 mb-2\",children:\"Section Splitting Process\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"text-blue-700 text-sm space-y-1\",children:[/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 Read all documents from \",config.source_database,\".\",config.source_collection]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 Split into exactly \",config.batch_size,\" batches with documents distributed evenly\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 Create collections: \",config.target_collection_prefix,\"1, \",config.target_collection_prefix,\"2, ...\"]}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Distribute statutes across batches as evenly as possible\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Maintain section structure and metadata\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:startSectionSplitting,disabled:isProcessing||!!prefixError,className:\"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\",children:isProcessing?'Processing...':'Start Section Splitting'}),/*#__PURE__*/_jsx(\"button\",{onClick:generateMetadata,className:\"bg-purple-600 text-white px-6 py-2 rounded-md hover:bg-purple-700\",children:\"Generate Metadata\"})]})]}),activeTab==='field-cleaning'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900\",children:\"Field Cleaning Configuration\"}),/*#__PURE__*/_jsx(\"button\",{onClick:fetchAvailableBatches,className:\"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700\",children:\"Load Available Batches\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-green-50 p-4 rounded-lg\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-green-900 mb-2\",children:\"Field Cleaning Process (per batch)\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"text-green-700 text-sm space-y-1\",children:[/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"strong\",{children:\"Drop unnecessary fields:\"}),\" Keep only essential fields for processing\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"strong\",{children:\"Bring common fields up:\"}),\" Move fields common across all sections to statute level\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"strong\",{children:\"Clean single-section statutes:\"}),\" Handle single-section statutes specially\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"strong\",{children:\"Remove preamble duplicates:\"}),\" Remove duplicate preamble sections\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"strong\",{children:\"Sort sections:\"}),\" Preamble first, then numeric, then text\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 \",/*#__PURE__*/_jsx(\"strong\",{children:\"Validate Pakistan law:\"}),\" Drop non-Pakistan laws using CLI logic\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 p-4 rounded-lg\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-gray-900 mb-3\",children:\"Cleaning Options\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"cleaningMode\",checked:cleanAllBatches,onChange:()=>setCleanAllBatches(true),className:\"mr-2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Clean All Batches\"})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"cleaningMode\",checked:!cleanAllBatches,onChange:()=>setCleanAllBatches(false),className:\"mr-2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Clean Selected Batches\"})]})]}),!cleanAllBatches&&availableBatches&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"font-medium text-gray-700 mb-2\",children:\"Select Batches to Clean:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-3 gap-2 max-h-48 overflow-y-auto\",children:availableBatches.batches.map(batch=>/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center space-x-2 text-sm\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedBatches.includes(batch.batch_number),onChange:()=>toggleBatchSelection(batch.batch_number),className:\"rounded\"}),/*#__PURE__*/_jsxs(\"span\",{className:batch.is_cleaned?\"text-green-600\":\"text-gray-700\",children:[batch.batch_name,\" (\",batch.document_count,\" docs)\",batch.is_cleaned&&/*#__PURE__*/_jsx(\"span\",{className:\"text-xs\",children:\" \\u2713\"})]})]},batch.batch_number))}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-500 mt-2\",children:[\"Selected: \",selectedBatches.length,\" batches. Green items are already cleaned.\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:startBatchCleaning,disabled:isProcessing||!!prefixError||!cleanAllBatches&&selectedBatches.length===0,className:\"bg-green-600 text-white px-6 py-2 rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed\",children:isProcessing?'Processing...':cleanAllBatches?'Clean All Batches':\"Clean \".concat(selectedBatches.length,\" Selected Batches\")}),/*#__PURE__*/_jsx(\"button\",{onClick:generateMetadata,className:\"bg-purple-600 text-white px-6 py-2 rounded-md hover:bg-purple-700\",children:\"Generate Metadata\"}),/*#__PURE__*/_jsx(\"button\",{onClick:refreshStatus,className:\"bg-gray-600 text-white px-6 py-2 rounded-md hover:bg-gray-700\",children:\"Refresh Status\"}),/*#__PURE__*/_jsx(\"button\",{onClick:async()=>{try{setIsProcessing(true);const response=await fetch('/api/v1/phase3/batch-diagnostics',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(config)});if(response.ok){const data=await response.json();setDiagnostics(data.batches||[]);}else{const err=await response.json();alert('Diagnostics failed: '+(err.detail||err.message));}}catch(e){console.error('Diagnostics error',e);alert('Diagnostics failed');}finally{setIsProcessing(false);}},className:\"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700\",children:\"Run Diagnostics\"})]}),diagnostics&&diagnostics.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 bg-white p-3 rounded border text-sm\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium mb-2\",children:\"Batch Diagnostics\"}),diagnostics.map(d=>/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:d.batch_name}),\": total=\",d.total_documents,\", legacy_cleaned=\",d.legacy_cleaned_count,\", modern_cleaned=\",d.modern_cleaned_count,\", any_cleaned=\",d.any_cleaned_count,/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-600 mt-1\",children:[\"legacy sample ids: \",d.legacy_samples.join(', ')||'none']}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-600\",children:[\"modern sample ids: \",d.modern_samples.join(', ')||'none']})]},d.batch_name))]})]}),activeTab==='pakistan-law-validation'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center mr-4\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:dryRun,onChange:e=>setDryRun(e.target.checked),className:\"mr-2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Dry Run (Preview Only)\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-500\",children:\"Preview which statutes will be dropped before actual deletion.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center mr-4\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:saveMetadata,onChange:e=>setSaveMetadata(e.target.checked),className:\"mr-2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-sm\",children:\"Generate Metadata\"})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-500\",children:\"Save validation statistics and analysis.\"})]})]}),validationResults&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 p-4 rounded-lg mt-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-2\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-gray-900\",children:\"Validation Results\"}),validationResults.metadata_file&&/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded\",children:[\"\\uD83D\\uDCC1 Metadata: \",validationResults.metadata_file]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2 text-sm\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Scanned:\"}),\" \",validationResults.total_scanned,\" \\xA0\",/*#__PURE__*/_jsx(\"strong\",{children:\"Dropped:\"}),\" \",validationResults.total_dropped,\" \\xA0\",/*#__PURE__*/_jsx(\"strong\",{children:\"Kept:\"}),\" \",validationResults.total_kept,\" \\xA0\",/*#__PURE__*/_jsx(\"strong\",{children:\"Batches:\"}),\" \",validationResults.processed_batches]}),validationResults.metadata&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2 text-xs bg-white p-2 rounded border\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Drop Analysis:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-2 mt-1\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"Drop Rate: \",(_validationResults$me=validationResults.metadata.validation_results)===null||_validationResults$me===void 0?void 0:(_validationResults$me2=_validationResults$me.drop_rate)===null||_validationResults$me2===void 0?void 0:_validationResults$me2.toFixed(1),\"%\"]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Keep Rate: \",(_validationResults$me3=validationResults.metadata.validation_results)===null||_validationResults$me3===void 0?void 0:(_validationResults$me4=_validationResults$me3.keep_rate)===null||_validationResults$me4===void 0?void 0:_validationResults$me4.toFixed(1),\"%\"]})]}),((_validationResults$me5=validationResults.metadata.drop_reason_analysis)===null||_validationResults$me5===void 0?void 0:_validationResults$me5.top_drop_reasons)&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-1\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Top Reasons:\"}),\" \",validationResults.metadata.drop_reason_analysis.top_drop_reasons.map(_ref=>{let[reason,count]=_ref;return\"\".concat(reason,\" (\").concat(count,\")\");}).join(', ')]})]}),validationResults.dropped_docs.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Dropped Statutes:\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"list-disc ml-6 text-xs\",children:validationResults.dropped_docs.map((doc,idx)=>/*#__PURE__*/_jsxs(\"li\",{children:[doc.name,/*#__PURE__*/_jsxs(\"span\",{className:\"text-red-600\",children:[\" (\",doc.reason,\")\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-500\",children:[\" [\",doc.batch,\"]\"]})]},doc.name+idx))})]}),validationResults.kept_docs.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Kept Statutes:\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"list-disc ml-6 text-xs\",children:validationResults.kept_docs.map((doc,idx)=>/*#__PURE__*/_jsxs(\"li\",{children:[doc.name,/*#__PURE__*/_jsx(\"span\",{className:\"text-green-600\",children:\" [Kept]\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-500\",children:[\" [\",doc.batch,\"]\"]})]},doc.name+idx))})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500\",children:validationResults.dry_run?\"No changes made (preview only)\":\"Non-Pakistan statutes have been dropped.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900\",children:\"Pakistan Law Validation Configuration\"}),/*#__PURE__*/_jsx(\"button\",{onClick:fetchAvailableBatches,className:\"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700\",children:\"Load Available Batches\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-yellow-50 p-4 rounded-lg\",children:/*#__PURE__*/_jsxs(\"ul\",{className:\"text-yellow-700 text-sm space-y-1\",children:[/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Drop non-Pakistan laws using CLI logic\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Validate all or selected batches\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 p-4 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",checked:cleanAllBatches,onChange:()=>setCleanAllBatches(true),className:\"mr-2\"}),\"Validate All\"]}),/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",checked:!cleanAllBatches,onChange:()=>setCleanAllBatches(false),className:\"mr-2\"}),\"Validate Selected\"]})]}),availableBatches===null&&/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-4 text-gray-500\",children:\"Click \\\"Load Available Batches\\\" to load batches for validation\"}),!cleanAllBatches&&availableBatches&&availableBatches.batches.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 grid grid-cols-3 gap-2 max-h-48 overflow-y-auto\",children:availableBatches.batches.map(b=>/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center space-x-2 text-sm\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:selectedBatches.includes(b.batch_number),onChange:()=>toggleBatchSelection(b.batch_number),className:\"rounded\"}),/*#__PURE__*/_jsxs(\"span\",{className:b.is_cleaned?'text-green-600':'text-gray-700',children:[b.batch_name,\" (\",b.document_count,\")\"]})]},b.batch_number))})]}),availableBatches&&availableBatches.batches.length===0&&/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-4 text-gray-500\",children:\"No batch collections found. Run section splitting first to create batches.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:startPakistanLawValidation,disabled:isProcessing||!!prefixError||!cleanAllBatches&&selectedBatches.length===0,className:\"bg-yellow-600 text-white px-6 py-2 rounded-md hover:bg-yellow-700 disabled:opacity-50\",children:isProcessing?'Processing...':cleanAllBatches?'Validate All':'Validate Selected'}),/*#__PURE__*/_jsx(\"button\",{onClick:previewValidationMetadata,disabled:isProcessing||!!prefixError||!cleanAllBatches&&selectedBatches.length===0,className:\"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50\",children:\"Preview Metadata\"}),/*#__PURE__*/_jsx(\"button\",{onClick:refreshStatus,className:\"bg-gray-600 text-white px-6 py-2 rounded-md hover:bg-gray-700\",children:\"Refresh Status\"})]})]}),activeTab==='preview'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900\",children:\"Batch Preview\"}),/*#__PURE__*/_jsx(\"button\",{onClick:fetchBatchPreview,className:\"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700\",children:\"Load Batch Preview\"})]}),batchPreview?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:batchPreview.batches.length>0?batchPreview.batches.map((batch,index)=>{var _batch$sample_documen;return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 p-4 rounded-lg\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-gray-900 mb-2\",children:batch.batch_name}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4 text-sm mb-3\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Documents:\"}),\" \",batch.document_count]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Sample Documents:\"}),\" \",((_batch$sample_documen=batch.sample_documents)===null||_batch$sample_documen===void 0?void 0:_batch$sample_documen.length)||0]})]}),batch.sample_documents&&batch.sample_documents.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500 mb-2\",children:\"Sample Documents (click to expand):\"}),batch.sample_documents.map((doc,docIndex)=>{var _doc$Sections;const statuteKey=\"\".concat(batch.batch_name,\"-\").concat(docIndex);const isStatuteExpanded=expandedStatutes[statuteKey];return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white border rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 cursor-pointer hover:bg-gray-50 flex items-center justify-between\",onClick:()=>toggleStatuteExpansion(statuteKey),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-sm text-gray-900\",children:doc.Statute_Name||'N/A'}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500\",children:[((_doc$Sections=doc.Sections)===null||_doc$Sections===void 0?void 0:_doc$Sections.length)||0,\" sections \\u2022 Province: \",doc.Province||'N/A']})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-400\",children:isStatuteExpanded?'▼':'▶'})]}),isStatuteExpanded&&doc.section_details&&/*#__PURE__*/_jsx(\"div\",{className:\"border-t border-gray-100\",children:doc.section_details.map((section,sectionIndex)=>{const sectionKey=\"\".concat(statuteKey,\"-section-\").concat(sectionIndex);const isSectionExpanded=expandedSections[sectionKey];return/*#__PURE__*/_jsxs(\"div\",{className:\"border-b border-gray-50 last:border-b-0\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 pl-6 cursor-pointer hover:bg-gray-25 flex items-center justify-between\",onClick:()=>toggleSectionExpansion(sectionKey),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-sm text-blue-900\",children:section.section_title}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500 mt-1\",children:section.content_preview})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-400 text-sm\",children:isSectionExpanded?'▼':'▶'})]}),isSectionExpanded&&/*#__PURE__*/_jsx(\"div\",{className:\"p-3 pl-8 bg-gray-50 border-t border-gray-100\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-800 whitespace-pre-wrap\",children:section.content||'No content available'})})]},sectionIndex);})}),isStatuteExpanded&&!doc.section_details&&doc.Sections&&/*#__PURE__*/_jsxs(\"div\",{className:\"border-t border-gray-100 p-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500 mb-2\",children:\"Basic Section Info:\"}),doc.Sections.map((section,sectionIndex)=>/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-700 mb-1\",children:[\"\\u2022 \",section.Section||\"Section \".concat(sectionIndex+1)]},sectionIndex))]})]},docIndex);})]})]},index);}):/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8 text-gray-500\",children:[/*#__PURE__*/_jsx(Layers,{className:\"h-12 w-12 mx-auto mb-4 text-gray-400\"}),/*#__PURE__*/_jsx(\"p\",{children:\"No batch collections found\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm\",children:\"Run section splitting first to create batches\"})]})}):/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8 text-gray-500\",children:[/*#__PURE__*/_jsx(Eye,{className:\"h-12 w-12 mx-auto mb-4 text-gray-400\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Click \\\"Load Batch Preview\\\" to see batch collections\"})]})]}),activeTab==='statistics'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900\",children:\"Processing Statistics\"}),/*#__PURE__*/_jsx(\"button\",{onClick:fetchStatistics,className:\"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700\",children:\"Load Statistics\"})]}),statistics?/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-blue-50 p-4 rounded-lg text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-blue-600\",children:((_statistics$statistic=statistics.statistics)===null||_statistics$statistic===void 0?void 0:(_statistics$statistic2=_statistics$statistic.source_collection)===null||_statistics$statistic2===void 0?void 0:_statistics$statistic2.count)||0}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-blue-600\",children:\"Source Documents\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-blue-500\",children:(_statistics$statistic3=statistics.statistics)===null||_statistics$statistic3===void 0?void 0:(_statistics$statistic4=_statistics$statistic3.source_collection)===null||_statistics$statistic4===void 0?void 0:_statistics$statistic4.name}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500\",children:(_statistics$statistic5=statistics.statistics)!==null&&_statistics$statistic5!==void 0&&(_statistics$statistic6=_statistics$statistic5.source_collection)!==null&&_statistics$statistic6!==void 0&&_statistics$statistic6.exists?'✅ Exists':'❌ Missing'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-green-50 p-4 rounded-lg text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-2xl font-bold text-green-600\",children:((_statistics$statistic7=statistics.statistics)===null||_statistics$statistic7===void 0?void 0:(_statistics$statistic8=_statistics$statistic7.target_database)===null||_statistics$statistic8===void 0?void 0:(_statistics$statistic9=_statistics$statistic8.batch_collections)===null||_statistics$statistic9===void 0?void 0:_statistics$statistic9.length)||0}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-green-600\",children:\"Batch Collections\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-green-500\",children:(_statistics$statistic0=statistics.statistics)===null||_statistics$statistic0===void 0?void 0:(_statistics$statistic1=_statistics$statistic0.target_database)===null||_statistics$statistic1===void 0?void 0:_statistics$statistic1.name}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500\",children:(_statistics$statistic10=statistics.statistics)!==null&&_statistics$statistic10!==void 0&&(_statistics$statistic11=_statistics$statistic10.target_database)!==null&&_statistics$statistic11!==void 0&&_statistics$statistic11.exists?'✅ Exists':'❌ Missing'})]}),((_statistics$statistic12=statistics.statistics)===null||_statistics$statistic12===void 0?void 0:(_statistics$statistic13=_statistics$statistic12.target_database)===null||_statistics$statistic13===void 0?void 0:_statistics$statistic13.batch_collections)&&/*#__PURE__*/_jsxs(\"div\",{className:\"md:col-span-2 bg-purple-50 p-4 rounded-lg\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-purple-900 mb-2\",children:\"Batch Collections\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm\",children:statistics.statistics.target_database.batch_collections.map((batch,index)=>/*#__PURE__*/_jsx(\"div\",{className:\"bg-white p-2 rounded text-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"font-medium\",children:batch})},index))})]})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8 text-gray-500\",children:[/*#__PURE__*/_jsx(Settings,{className:\"h-12 w-12 mx-auto mb-4 text-gray-400\"}),/*#__PURE__*/_jsx(\"p\",{children:\"No statistics available\"}),/*#__PURE__*/_jsx(\"button\",{onClick:fetchStatistics,className:\"mt-2 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700\",children:\"Load Statistics\"})]})]}),activeTab==='history'&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900\",children:\"Processing History\"}),/*#__PURE__*/_jsx(\"button\",{onClick:fetchHistory,className:\"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700\",children:\"Refresh History\"})]}),history?/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:history.history.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full divide-y divide-gray-200\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Operation\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Database\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Collection\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Date\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Processed\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"bg-white divide-y divide-gray-200\",children:history.history.map((item,index)=>/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\",children:/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium \".concat(item.operation_type==='split'?'bg-blue-100 text-blue-800':'bg-green-100 text-green-800'),children:item.operation_type==='split'?'Section Splitting':'Field Cleaning'})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\",children:item.database}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\",children:item.collection}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\",children:new Date(item.created_at).toLocaleDateString()}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\",children:[item.total_processed,\" items\"]}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>window.open(\"/api/v1/phase3/history/\".concat(item.filename),'_blank'),className:\"text-indigo-600 hover:text-indigo-900\",children:\"View Details\"})})]},index))})]})}):/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8 text-gray-500\",children:[/*#__PURE__*/_jsx(History,{className:\"h-12 w-12 mx-auto mb-4 text-gray-400\"}),/*#__PURE__*/_jsx(\"p\",{children:\"No processing history found\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm\",children:\"Run section splitting or field cleaning to generate history\"})]})}):/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8 text-gray-500\",children:[/*#__PURE__*/_jsx(History,{className:\"h-12 w-12 mx-auto mb-4 text-gray-400\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Click \\\"Refresh History\\\" to load processing history\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 text-xs text-gray-500\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"\\u2022 Section splitting creates batch collections\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u2022 Field cleaning processes each batch individually\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u2022 All operations are logged with timestamps\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u2022 Metadata files contain detailed statistics\"})]})]})]})]})]});};export default Phase3;","map":{"version":3,"names":["React","useState","useEffect","Scissors","Database","FileText","Settings","History","Eye","RotateCcw","Split","Layers","Loader2","AlertCircle","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","DEFAULT_CONFIG","source_database","source_collection","target_database","target_collection_prefix","batch_size","enable_ai_cleaning","Phase3","_status$collection_st","_status$collection_st2","_status$collection_st3","_status$collection_st4","_validationResults$me","_validationResults$me2","_validationResults$me3","_validationResults$me4","_validationResults$me5","_statistics$statistic","_statistics$statistic2","_statistics$statistic3","_statistics$statistic4","_statistics$statistic5","_statistics$statistic6","_statistics$statistic7","_statistics$statistic8","_statistics$statistic9","_statistics$statistic0","_statistics$statistic1","_statistics$statistic10","_statistics$statistic11","_statistics$statistic12","_statistics$statistic13","activeTab","setActiveTab","config","setConfig","isProcessing","setIsProcessing","status","setStatus","statistics","setStatistics","batchPreview","setBatchPreview","progressStep","setProgressStep","progressDetails","setProgressDetails","processingStats","setProcessingStats","operationError","setOperationError","prefixError","setPrefixError","history","setHistory","availableBatches","setAvailableBatches","diagnostics","setDiagnostics","selectedBatches","setSelectedBatches","cleanAllBatches","setCleanAllBatches","dryRun","setDryRun","validationResults","setValidationResults","saveMetadata","setSaveMetadata","expandedStatutes","setExpandedStatutes","expandedSections","setExpandedSections","savedConfig","localStorage","getItem","JSON","parse","error","console","setItem","stringify","updateConfig","updates","newConfig","_objectSpread","v","validatePrefix","prefix","trim","ok","test","startsWith","toLowerCase","resetConfig","fetchStatus","response","fetch","data","json","refreshStatus","fetchAvailableBatches","fetchStatistics","method","headers","body","fetchBatchPreview","fetchHistory","generateMetadata","result","alert","concat","metadata_file","detail","startSectionSplitting","batches_created","batchCount","processed","total","operation","setTimeout","Error","errorMessage","message","startFieldCleaning","batches","batches_scheduled","length","startBatchCleaning","payload","batch_numbers","clean_all","startPakistanLawValidation","url","err","previewValidationMetadata","estimated_documents","batches_to_process","toggleBatchSelection","batchNumber","prev","includes","filter","n","toggleStatuteExpansion","statuteKey","toggleSectionExpansion","sectionKey","rollbackPhase3","window","confirm","tabs","id","name","icon","className","children","onClick","type","value","onChange","e","target","parseInt","min","max","map","tab","Icon","disabled","toLocaleString","style","width","collection_status","source_exists","source_count","target_database_exists","batch_count","checked","batch","batch_number","is_cleaned","batch_name","document_count","d","total_documents","legacy_cleaned_count","modern_cleaned_count","any_cleaned_count","legacy_samples","join","modern_samples","total_scanned","total_dropped","total_kept","processed_batches","metadata","validation_results","drop_rate","toFixed","keep_rate","drop_reason_analysis","top_drop_reasons","_ref","reason","count","dropped_docs","doc","idx","kept_docs","dry_run","b","index","_batch$sample_documen","sample_documents","docIndex","_doc$Sections","isStatuteExpanded","Statute_Name","Sections","Province","section_details","section","sectionIndex","isSectionExpanded","section_title","content_preview","content","Section","exists","batch_collections","item","operation_type","database","collection","Date","created_at","toLocaleDateString","total_processed","open","filename"],"sources":["D:/DigiFloat/LawChronicle/frontend/src/pages/Phase3.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Scissors, Database, FileText, Settings, History, Eye, Play, RotateCcw, Split, Layers, Loader2, AlertCircle } from 'lucide-react';\r\n\r\n// Configuration interface - updated to match CLI flow\r\ninterface Phase3Config {\r\n  source_database: string;\r\n  source_collection: string;\r\n  target_database: string;\r\n  target_collection_prefix: string;\r\n  batch_size: number;\r\n  enable_ai_cleaning: boolean;\r\n}\r\n\r\n// Default configuration - matches CLI scripts\r\nconst DEFAULT_CONFIG: Phase3Config = {\r\n  source_database: \"Statutes\",\r\n  source_collection: \"normalized_statutes\",\r\n  target_database: \"Batched-Statutes\",\r\n  target_collection_prefix: \"batch_\",\r\n  batch_size: 10,\r\n  enable_ai_cleaning: false\r\n};\r\n\r\nconst Phase3: React.FC = () => {\r\n  const [activeTab, setActiveTab] = useState('overview');\r\n  const [config, setConfig] = useState<Phase3Config>(DEFAULT_CONFIG);\r\n  const [isProcessing, setIsProcessing] = useState(false);\r\n  const [status, setStatus] = useState<any>(null);\r\n  const [statistics, setStatistics] = useState<any>(null);\r\n  const [batchPreview, setBatchPreview] = useState<any>(null);\r\n  const [progressStep, setProgressStep] = useState<string>('');\r\n  const [progressDetails, setProgressDetails] = useState<string>('');\r\n  const [processingStats, setProcessingStats] = useState<{processed: number, total: number, operation: string} | null>(null);\r\n  const [operationError, setOperationError] = useState<string | null>(null);\r\n  const [prefixError, setPrefixError] = useState<string | null>(null);\r\n  const [history, setHistory] = useState<any>(null);\r\n  const [availableBatches, setAvailableBatches] = useState<any>(null);\r\n  const [diagnostics, setDiagnostics] = useState<any>(null);\r\n  const [selectedBatches, setSelectedBatches] = useState<number[]>([]);\r\n  const [cleanAllBatches, setCleanAllBatches] = useState(true);\r\n  const [dryRun, setDryRun] = useState(true);\r\n  const [validationResults, setValidationResults] = useState<any>(null);\r\n  const [saveMetadata, setSaveMetadata] = useState<boolean>(true);\r\n  const [expandedStatutes, setExpandedStatutes] = useState<{[key: string]: boolean}>({});\r\n  const [expandedSections, setExpandedSections] = useState<{[key: string]: boolean}>({});\r\n\r\n  // Load config from localStorage on mount\r\n  useEffect(() => {\r\n    const savedConfig = localStorage.getItem('phase3_config');\r\n    if (savedConfig) {\r\n      try {\r\n        setConfig(JSON.parse(savedConfig));\r\n      } catch (error) {\r\n        console.error('Error loading Phase 3 config:', error);\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  // Save config to localStorage when it changes\r\n  useEffect(() => {\r\n    localStorage.setItem('phase3_config', JSON.stringify(config));\r\n  }, [config]);\r\n\r\n  // Update configuration\r\n  const updateConfig = (updates: Partial<Phase3Config>) => {\r\n    const newConfig = { ...config, ...updates };\r\n    setConfig(newConfig);\r\n    // Validate prefix\r\n    if ('target_collection_prefix' in updates) {\r\n      const v = (updates as any).target_collection_prefix as string;\r\n      validatePrefix(v);\r\n    }\r\n  };\r\n\r\n  const validatePrefix = (prefix: string) => {\r\n    if (!prefix || !prefix.trim()) {\r\n      setPrefixError('Prefix cannot be empty');\r\n      return false;\r\n    }\r\n    const ok = /^[A-Za-z0-9_-]{1,50}$/.test(prefix.trim());\r\n    if (!ok) {\r\n      setPrefixError('Use only letters, numbers, underscore or hyphen (1-50 chars)');\r\n      return false;\r\n    }\r\n    if (prefix.trim().startsWith('$') || prefix.trim().toLowerCase().startsWith('system')) {\r\n      setPrefixError('Prefix cannot start with \"$\" or \"system\"');\r\n      return false;\r\n    }\r\n    setPrefixError(null);\r\n    return true;\r\n  };\r\n\r\n  // Reset configuration to defaults\r\n  const resetConfig = () => {\r\n    setConfig(DEFAULT_CONFIG);\r\n  };\r\n\r\n  // Fetch Phase 3 status\r\n  const fetchStatus = async () => {\r\n    try {\r\n      const response = await fetch('/api/v1/phase3/status');\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setStatus(data);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching Phase 3 status:', error);\r\n    }\r\n  };\r\n\r\n  // Refresh status and related data; when on Pakistan tab also refresh available batches\r\n  const refreshStatus = async () => {\r\n    await fetchStatus();\r\n    // If user is on Pakistan validation tab, refresh batch listings so document counts update\r\n    if (activeTab === 'pakistan-law-validation') {\r\n      await fetchAvailableBatches();\r\n    }\r\n    // If on statistics tab refresh stats as well\r\n    if (activeTab === 'statistics') {\r\n      await fetchStatistics();\r\n    }\r\n  };\r\n\r\n  // Fetch statistics\r\n  const fetchStatistics = async () => {\r\n    try {\r\n      const response = await fetch('/api/v1/phase3/statistics', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(config)\r\n      });\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setStatistics(data);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching Phase 3 statistics:', error);\r\n    }\r\n  };\r\n\r\n  // Fetch batch preview\r\n  const fetchBatchPreview = async () => {\r\n    try {\r\n      const response = await fetch('/api/v1/phase3/preview-batches', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(config)\r\n      });\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setBatchPreview(data);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching batch preview:', error);\r\n    }\r\n  };\r\n\r\n  // Fetch history\r\n  const fetchHistory = async () => {\r\n    try {\r\n      const response = await fetch('/api/v1/phase3/history');\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setHistory(data);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching history:', error);\r\n    }\r\n  };\r\n\r\n  // Fetch available batches for cleaning\r\n  const fetchAvailableBatches = async () => {\r\n    try {\r\n      const response = await fetch('/api/v1/phase3/available-batches', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(config)\r\n      });\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setAvailableBatches(data);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching available batches:', error);\r\n    }\r\n  };\r\n\r\n  // Generate metadata\r\n  const generateMetadata = async () => {\r\n    try {\r\n      const response = await fetch('/api/v1/phase3/generate-metadata', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(config)\r\n      });\r\n      \r\n      if (response.ok) {\r\n        const result = await response.json();\r\n        alert(`Metadata generated successfully! File: ${result.metadata_file}`);\r\n        fetchHistory();\r\n      } else {\r\n        const error = await response.json();\r\n        alert(`Error generating metadata: ${error.detail}`);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error generating metadata:', error);\r\n      alert('Failed to generate metadata');\r\n    }\r\n  };\r\n\r\n  // Start section splitting using modern service endpoint\r\n  const startSectionSplitting = async () => {\r\n    setIsProcessing(true);\r\n    setOperationError(null);\r\n    setProgressStep('Initializing section splitting process...');\r\n    setProgressDetails('Preparing to analyze and split statute sections');\r\n    setProcessingStats(null);\r\n    \r\n    try {\r\n      // Step 1: Prepare request\r\n      setProgressStep('Preparing section splitting request');\r\n      setProgressDetails(`Source: ${config.source_database}.${config.source_collection} → Target: ${config.target_database}.${config.target_collection_prefix}*`);\r\n      \r\n      // Step 2: Send to the correct endpoint\r\n      setProgressStep('Connecting to section splitting service');\r\n      setProgressDetails('Analyzing statute structure and splitting into batches...');\r\n\r\n      const response = await fetch('/api/v1/phase3/start-section-splitting', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(config)\r\n      });\r\n      \r\n      // Step 3: Process results\r\n      setProgressStep('Processing section splitting results');\r\n      setProgressDetails('Analyzing split sections and organizing data...');\r\n      \r\n      if (response.ok) {\r\n        const result = await response.json();\r\n        setProgressStep('Section splitting completed successfully!');\r\n        setProgressDetails(`Successfully created ${result.batches_created || 0} batch collections`);\r\n        \r\n        // Show success notification with details\r\n        const batchCount = result.batches_created || 0;\r\n        setProcessingStats({\r\n          processed: batchCount,\r\n          total: batchCount,\r\n          operation: 'Section Splitting'\r\n        });\r\n        \r\n        fetchStatus();\r\n        \r\n        // Clear progress after delay\r\n        setTimeout(() => {\r\n          setProgressStep('');\r\n          setProgressDetails('');\r\n          setProcessingStats(null);\r\n        }, 3000);\r\n      } else {\r\n        const error = await response.json();\r\n        throw new Error(error.detail || 'Section splitting failed');\r\n      }\r\n    } catch (error) {\r\n      setProgressStep('Error during section splitting');\r\n      const errorMessage = error instanceof Error ? error.message : 'Failed to start section splitting';\r\n      setProgressDetails(errorMessage);\r\n      setOperationError(errorMessage);\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  };\r\n\r\n  // Start field cleaning using modern service endpoint\r\n  const startFieldCleaning = async () => {\r\n    setIsProcessing(true);\r\n    setOperationError(null);\r\n    setProgressStep('Initializing field cleaning process...');\r\n    setProgressDetails('Preparing to clean and validate field data');\r\n    setProcessingStats(null);\r\n    \r\n    try {\r\n      // Step 1: Prepare cleaning request (send the Phase3 config)\r\n      setProgressStep('Preparing field cleaning request');\r\n      setProgressDetails(`Scheduling cleaning for collections with prefix: ${config.target_collection_prefix}`);\r\n\r\n      // Step 2: Schedule cleaning on the backend (background task)\r\n      setProgressStep('Scheduling field cleaning on server');\r\n      setProgressDetails('Requesting server to start field cleaning in background...');\r\n\r\n      const response = await fetch('/api/v1/phase3/start-field-cleaning', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(config)\r\n      });\r\n      \r\n      // Step 3: Process cleaning results\r\n      setProgressStep('Processing field cleaning results');\r\n      setProgressDetails('Validating cleaned data and updating collections...');\r\n      \r\n      if (response.ok) {\r\n        const result = await response.json();\r\n        const batches = result.batches_scheduled || [];\r\n\r\n        setProgressStep('Field cleaning scheduled');\r\n        setProgressDetails(`Cleaning scheduled for ${batches.length} batches. Server is processing in background.`);\r\n\r\n        setProcessingStats({\r\n          processed: batches.length,\r\n          total: batches.length || 1,\r\n          operation: 'Field Cleaning'\r\n        });\r\n\r\n  fetchStatus();\r\n  // Refresh available batches so cleaned flags update immediately\r\n  fetchAvailableBatches();\r\n  fetchHistory(); // refresh history to show new metadata\r\n\r\n        // Clear progress after short delay but keep status visible\r\n        setTimeout(() => {\r\n          setProgressStep('');\r\n          setProgressDetails('');\r\n        }, 3000);\r\n      } else {\r\n        const error = await response.json();\r\n        throw new Error(error.detail || 'Field cleaning scheduling failed');\r\n      }\r\n    } catch (error) {\r\n      setProgressStep('Error during field cleaning');\r\n      const errorMessage = error instanceof Error ? error.message : 'Failed to start field cleaning';\r\n      setProgressDetails(errorMessage);\r\n      setOperationError(errorMessage);\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  };\r\n\r\n  // Start batch cleaning (using service architecture)\r\n  const startBatchCleaning = async () => {\r\n    setIsProcessing(true);\r\n    try {\r\n      // Build payload matching the backend BatchCleaningConfig model\r\n      const payload = {\r\n        target_database: config.target_database,\r\n        target_collection_prefix: config.target_collection_prefix,\r\n        batch_numbers: cleanAllBatches ? null : selectedBatches,\r\n        clean_all: cleanAllBatches\r\n      };\r\n\r\n      // Call the dedicated endpoint that schedules cleaning for selected batches\r\n      const response = await fetch('/api/v1/phase3/clean-batches', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(payload)\r\n      });\r\n\r\n      if (response.ok) {\r\n        const result = await response.json();\r\n        alert('Batch cleaning started successfully!');\r\n  // Refresh status and batches so UI reflects scheduled cleaning\r\n  refreshStatus();\r\n  fetchHistory();\r\n      } else {\r\n        const error = await response.json();\r\n        alert(`Error starting batch cleaning: ${error.detail || error.message || 'Unknown error'}`);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error starting batch cleaning:', error);\r\n      alert('Failed to start batch cleaning');\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  };\r\n  // Start Pakistan Law Validation\r\n  const startPakistanLawValidation = async () => {\r\n    setIsProcessing(true);\r\n    setValidationResults(null);\r\n    try {\r\n      const payload = {\r\n        target_database: config.target_database,\r\n        target_collection_prefix: config.target_collection_prefix,\r\n        batch_numbers: cleanAllBatches ? null : selectedBatches,\r\n        clean_all: cleanAllBatches\r\n      };\r\n  const url = `/api/v1/phase3/validate-pakistan-batches?dry_run=${dryRun}&save_metadata=${saveMetadata}`;\r\n      const response = await fetch(url, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(payload)\r\n      });\r\n      if (response.ok) {\r\n        const result = await response.json();\r\n        setValidationResults(result);\r\n        fetchStatus();\r\n        fetchHistory();\r\n      } else {\r\n        const err = await response.json();\r\n        alert(`Error during validation: ${err.message || err.detail}`);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error validating Pakistan law batches:', error);\r\n      alert('Pakistan law validation failed');\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  };\r\n\r\n  // Preview validation metadata\r\n  const previewValidationMetadata = async () => {\r\n    setIsProcessing(true);\r\n    try {\r\n      const payload = {\r\n        target_database: config.target_database,\r\n        target_collection_prefix: config.target_collection_prefix,\r\n        batch_numbers: cleanAllBatches ? null : selectedBatches,\r\n        clean_all: cleanAllBatches\r\n      };\r\n      const response = await fetch('/api/v1/phase3/preview-validation-metadata', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(payload)\r\n      });\r\n      if (response.ok) {\r\n        const result = await response.json();\r\n        alert(`Metadata Preview:\\n\\nEstimated Documents: ${result.estimated_documents}\\nBatches: ${result.batches_to_process.length}\\n\\nMetadata structure generated successfully!`);\r\n      } else {\r\n        const err = await response.json();\r\n        alert(`Error previewing metadata: ${err.message || err.detail}`);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error previewing validation metadata:', error);\r\n      alert('Metadata preview failed');\r\n    } finally {\r\n      setIsProcessing(false);\r\n    }\r\n  };\r\n\r\n  // Handle batch selection\r\n  const toggleBatchSelection = (batchNumber: number) => {\r\n    setSelectedBatches(prev => \r\n      prev.includes(batchNumber) \r\n        ? prev.filter(n => n !== batchNumber)\r\n        : [...prev, batchNumber]\r\n    );\r\n  };\r\n\r\n  // Toggle statute expansion\r\n  const toggleStatuteExpansion = (statuteKey: string) => {\r\n    setExpandedStatutes(prev => ({\r\n      ...prev,\r\n      [statuteKey]: !prev[statuteKey]\r\n    }));\r\n  };\r\n\r\n  // Toggle section expansion\r\n  const toggleSectionExpansion = (sectionKey: string) => {\r\n    setExpandedSections(prev => ({\r\n      ...prev,\r\n      [sectionKey]: !prev[sectionKey]\r\n    }));\r\n  };\r\n\r\n  // Rollback Phase 3\r\n  const rollbackPhase3 = async () => {\r\n    if (!window.confirm('Are you sure you want to rollback Phase 3? This will delete all created batch collections and databases.')) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await fetch('/api/v1/phase3/rollback', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(config)\r\n      });\r\n      \r\n      if (response.ok) {\r\n        const result = await response.json();\r\n        alert('Phase 3 rollback completed successfully!');\r\n        fetchStatus();\r\n        fetchStatistics();\r\n      } else {\r\n        const error = await response.json();\r\n        alert(`Error rolling back Phase 3: ${error.detail}`);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error rolling back Phase 3:', error);\r\n      alert('Failed to rollback Phase 3');\r\n    }\r\n  };\r\n\r\n  // Load data on mount\r\n  useEffect(() => {\r\n    fetchStatus();\r\n    fetchStatistics();\r\n  }, []);\r\n  // Auto-load batches when Pakistan Law Validation tab is active\r\n  useEffect(() => {\r\n    if (activeTab === 'pakistan-law-validation') {\r\n      fetchAvailableBatches();\r\n    }\r\n  }, [activeTab]);\r\n\r\n  const tabs = [\r\n    { id: 'overview', name: 'Overview', icon: Database },\r\n    { id: 'section-splitting', name: 'Section Splitting', icon: Split },\r\n    { id: 'field-cleaning', name: 'Field Cleaning', icon: Scissors },\r\n    { id: 'pakistan-law-validation', name: 'Pakistan Law Validation', icon: FileText },\r\n    { id: 'preview', name: 'Batch Preview', icon: Eye },\r\n    { id: 'statistics', name: 'Statistics', icon: Settings },\r\n    { id: 'history', name: 'History', icon: History }\r\n  ];\r\n  // Start Pakistan Law Validation (mirrors batch cleaning, but uses different processing_type)\r\n\r\n  return (\r\n    <div className=\"space-y-0\">\r\n      {/* Header */}\r\n      <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-2\">\r\n        <h1 className=\"text-xl font-bold text-gray-900 mb-1\">\r\n          Phase 3: Field Cleaning & Splitting\r\n        </h1>\r\n        <p className=\"text-gray-600 text-sm\">\r\n          Split normalized statutes into batches, then clean each batch using CLI logic\r\n        </p>\r\n      </div>\r\n\r\n      {/* Current Configuration */}\r\n      <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-2 mt-2\">\r\n        <div className=\"flex items-center justify-between mb-2\">\r\n          <h2 className=\"text-lg font-semibold text-gray-900\">Current Configuration</h2>\r\n          <button\r\n            onClick={resetConfig}\r\n            className=\"inline-flex items-center px-3 py-1 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500\"\r\n          >\r\n            <RotateCcw className=\"h-4 w-4 mr-1\" />\r\n            Reset to Defaults\r\n          </button>\r\n        </div>\r\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm\">\r\n          <div>\r\n            <span className=\"font-medium text-gray-700\">Source DB:</span>\r\n            <input\r\n              type=\"text\"\r\n              value={config.source_database}\r\n              onChange={(e) => updateConfig({ source_database: e.target.value })}\r\n              className=\"ml-2 px-2 py-1 border border-gray-300 rounded text-xs w-full\"\r\n            />\r\n          </div>\r\n          <div>\r\n            <span className=\"font-medium text-gray-700\">Source Collection:</span>\r\n            <input\r\n              type=\"text\"\r\n              value={config.source_collection}\r\n              onChange={(e) => updateConfig({ source_collection: e.target.value })}\r\n              className=\"ml-2 px-2 py-1 border border-gray-300 rounded text-xs w-full\"\r\n            />\r\n          </div>\r\n          <div>\r\n            <span className=\"font-medium text-gray-700\">Target DB:</span>\r\n            <input\r\n              type=\"text\"\r\n              value={config.target_database}\r\n              onChange={(e) => updateConfig({ target_database: e.target.value })}\r\n              className=\"ml-2 px-2 py-1 border border-gray-300 rounded text-xs w-full\"\r\n            />\r\n          </div>\r\n              <div>\r\n                <span className=\"font-medium text-gray-700\">Batch Prefix:</span>\r\n                <input\r\n                  type=\"text\"\r\n                  value={config.target_collection_prefix}\r\n                  onChange={(e) => updateConfig({ target_collection_prefix: e.target.value })}\r\n                  className=\"ml-2 px-2 py-1 border border-gray-300 rounded text-xs w-full\"\r\n                />\r\n                {prefixError && (\r\n                  <div className=\"text-xs text-red-600 mt-1\">{prefixError}</div>\r\n                )}\r\n              </div>\r\n          <div>\r\n            <span className=\"font-medium text-gray-700\">Number of Batches:</span>\r\n            <input\r\n              type=\"number\"\r\n              value={config.batch_size}\r\n              onChange={(e) => updateConfig({ batch_size: parseInt(e.target.value) || 10 })}\r\n              className=\"ml-2 px-2 py-1 border border-gray-300 rounded text-xs w-16\"\r\n              min=\"1\"\r\n              max=\"50\"\r\n            />\r\n          </div>\r\n          {/* AI-enhanced cleaning option hidden while feature is under review for interviews */}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Tab Navigation */}\r\n      <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 mt-2\">\r\n        <nav className=\"flex space-x-8 px-4\" aria-label=\"Tabs\">\r\n          {tabs.map((tab) => {\r\n            const Icon = tab.icon;\r\n            return (\r\n              <button\r\n                key={tab.id}\r\n                onClick={() => setActiveTab(tab.id)}\r\n                className={`py-3 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 ${\r\n                  activeTab === tab.id\r\n                    ? 'border-purple-500 text-purple-600'\r\n                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\r\n                }`}\r\n              >\r\n                <Icon className=\"h-4 w-4\" />\r\n                <span>{tab.name}</span>\r\n              </button>\r\n            );\r\n          })}\r\n        </nav>\r\n      </div>\r\n\r\n      {/* Tab Content */}\r\n      <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mt-2\">\r\n        {activeTab === 'overview' && (\r\n          <div className=\"space-y-4\">\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"bg-blue-50 p-4 rounded-lg\">\r\n                <h3 className=\"text-lg font-semibold text-blue-900 mb-2 flex items-center\">\r\n                  <Split className=\"h-5 w-5 mr-2\" />\r\n                  Section Splitting\r\n                </h3>\r\n                <p className=\"text-blue-700 text-sm mb-3\">\r\n                  Split normalized statutes from {config.source_database}.{config.source_collection} into {config.batch_size} equal batches in {config.target_database}.\r\n                </p>\r\n                <button\r\n                  onClick={startSectionSplitting}\r\n                  disabled={isProcessing}\r\n                  className=\"w-full bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                >\r\n                  {isProcessing ? (\r\n                    <>\r\n                      <Loader2 className=\"w-4 h-4 mr-2 inline animate-spin\" />\r\n                      {progressStep || 'Processing...'}\r\n                    </>\r\n                  ) : (\r\n                    'Start Section Splitting'\r\n                  )}\r\n                </button>\r\n              </div>\r\n\r\n              <div className=\"bg-green-50 p-4 rounded-lg\">\r\n                <h3 className=\"text-lg font-semibold text-green-900 mb-2 flex items-center\">\r\n                  <Scissors className=\"h-5 w-5 mr-2\" />\r\n                  Field Cleaning\r\n                </h3>\r\n                <p className=\"text-green-700 text-sm mb-3\">\r\n                  Clean each batch using CLI logic: drop unnecessary fields, bring common fields up, handle single sections, remove duplicates, and sort sections.\r\n                </p>\r\n                <button\r\n                  onClick={startFieldCleaning}\r\n                  disabled={isProcessing || !!prefixError}\r\n                  className=\"w-full bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                >\r\n                  {isProcessing ? (\r\n                    <>\r\n                      <Loader2 className=\"w-4 h-4 mr-2 inline animate-spin\" />\r\n                      {progressStep || 'Processing...'}\r\n                    </>\r\n                  ) : (\r\n                    'Start Field Cleaning'\r\n                  )}\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Enhanced Processing Progress Display */}\r\n            {isProcessing && (\r\n              <div className=\"bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-6 mb-6\">\r\n                <div className=\"flex items-center justify-between mb-4\">\r\n                  <h3 className=\"text-lg font-semibold text-gray-900\">Processing Status</h3>\r\n                  <div className=\"flex items-center\">\r\n                    <Loader2 className=\"w-5 h-5 text-blue-600 animate-spin mr-2\" />\r\n                    <span className=\"text-sm font-medium text-blue-700\">In Progress</span>\r\n                  </div>\r\n                </div>\r\n                \r\n                {progressStep && (\r\n                  <div className=\"mb-3\">\r\n                    <div className=\"text-base font-medium text-gray-800 mb-1\">\r\n                      {progressStep}\r\n                    </div>\r\n                    {progressDetails && (\r\n                      <div className=\"text-sm text-gray-600\">\r\n                        {progressDetails}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                )}\r\n                \r\n                {processingStats && (\r\n                  <div className=\"bg-white rounded-lg p-4 border border-gray-200\">\r\n                    <div className=\"flex justify-between items-center mb-2\">\r\n                      <span className=\"text-sm font-medium text-gray-700\">{processingStats.operation}</span>\r\n                      <span className=\"text-sm text-gray-600\">\r\n                        {processingStats.processed.toLocaleString()} processed\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"w-full bg-gray-200 rounded-full h-3\">\r\n                      <div \r\n                        className=\"bg-gradient-to-r from-blue-500 to-purple-600 h-3 rounded-full transition-all duration-500 ease-out\" \r\n                        style={{ width: `${(processingStats.processed / processingStats.total) * 100}%` }}\r\n                      ></div>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            )}\r\n\r\n            {/* Enhanced Error Display */}\r\n            {operationError && (\r\n              <div className=\"bg-red-50 border border-red-200 rounded-lg p-6 mb-6\">\r\n                <div className=\"flex items-start\">\r\n                  <AlertCircle className=\"w-5 h-5 text-red-600 mr-3 mt-0.5\" />\r\n                  <div className=\"flex-1\">\r\n                    <h3 className=\"text-base font-medium text-red-900 mb-2\">Operation Failed</h3>\r\n                    <div className=\"text-sm text-red-800 mb-3\">{operationError}</div>\r\n                    <div className=\"text-xs text-red-600\">\r\n                      <strong>Troubleshooting Steps:</strong>\r\n                      <ul className=\"mt-2 ml-4 list-disc space-y-1\">\r\n                        <li>Verify database connection is active</li>\r\n                        <li>Check that source collections contain data</li>\r\n                        <li>Ensure sufficient permissions for target database</li>\r\n                        <li>Review configuration settings for accuracy</li>\r\n                        <li>Try refreshing the page and attempting the operation again</li>\r\n                      </ul>\r\n                    </div>\r\n                    <button\r\n                      onClick={() => setOperationError(null)}\r\n                      className=\"mt-3 text-sm text-red-600 hover:text-red-800 underline\"\r\n                    >\r\n                      Dismiss error\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Status Overview */}\r\n            {status && (\r\n              <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n                <h3 className=\"text-lg font-semibold text-gray-900 mb-3\">Current Status</h3>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                  <div className=\"text-center\">\r\n                    <div className=\"text-2xl font-bold text-blue-600\">\r\n                      {status.collection_status?.source_exists ? '✅' : '❌'}\r\n                    </div>\r\n                    <div className=\"text-sm text-gray-600\">Source Collection</div>\r\n                    <div className=\"text-xs text-gray-500\">{config.source_database}.{config.source_collection}</div>\r\n                    {status.collection_status?.source_count > 0 && (\r\n                      <div className=\"text-xs text-gray-500\">{status.collection_status.source_count} documents</div>\r\n                    )}\r\n                  </div>\r\n                  <div className=\"text-center\">\r\n                    <div className=\"text-2xl font-bold text-green-600\">\r\n                      {status.collection_status?.target_database_exists ? '✅' : '❌'}\r\n                    </div>\r\n                    <div className=\"text-sm text-gray-600\">Target Database</div>\r\n                    <div className=\"text-xs text-gray-500\">{config.target_database}</div>\r\n                  </div>\r\n                  <div className=\"text-center\">\r\n                    <div className=\"text-2xl font-bold text-purple-600\">\r\n                      {status.collection_status?.batch_count || 0}\r\n                    </div>\r\n                    <div className=\"text-sm text-gray-600\">Batch Collections</div>\r\n                    <div className=\"text-xs text-gray-500\">{config.target_collection_prefix}1, {config.target_collection_prefix}2, ...</div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Rollback Section */}\r\n            <div className=\"bg-red-50 p-4 rounded-lg\">\r\n              <h3 className=\"text-lg font-semibold text-red-900 mb-2\">Rollback</h3>\r\n              <p className=\"text-red-700 text-sm mb-3\">\r\n                Rollback Phase 3 changes and restore previous state if needed.\r\n              </p>\r\n              <button\r\n                onClick={rollbackPhase3}\r\n                className=\"w-full bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700\"\r\n              >\r\n                Rollback Phase 3\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {activeTab === 'section-splitting' && (\r\n          <div className=\"space-y-4\">\r\n            <h3 className=\"text-lg font-semibold text-gray-900\">Section Splitting Configuration</h3>\r\n            <div className=\"bg-blue-50 p-4 rounded-lg\">\r\n              <h4 className=\"font-medium text-blue-900 mb-2\">Section Splitting Process</h4>\r\n              <ul className=\"text-blue-700 text-sm space-y-1\">\r\n                <li>• Read all documents from {config.source_database}.{config.source_collection}</li>\r\n                <li>• Split into exactly {config.batch_size} batches with documents distributed evenly</li>\r\n                <li>• Create collections: {config.target_collection_prefix}1, {config.target_collection_prefix}2, ...</li>\r\n                <li>• Distribute statutes across batches as evenly as possible</li>\r\n                <li>• Maintain section structure and metadata</li>\r\n              </ul>\r\n            </div>\r\n            \r\n            <div className=\"flex space-x-4\">\r\n              <button\r\n                onClick={startSectionSplitting}\r\n                disabled={isProcessing || !!prefixError}\r\n                className=\"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n              >\r\n                {isProcessing ? 'Processing...' : 'Start Section Splitting'}\r\n              </button>\r\n              <button\r\n                onClick={generateMetadata}\r\n                className=\"bg-purple-600 text-white px-6 py-2 rounded-md hover:bg-purple-700\"\r\n              >\r\n                Generate Metadata\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {activeTab === 'field-cleaning' && (\r\n          <div className=\"space-y-4\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <h3 className=\"text-lg font-semibold text-gray-900\">Field Cleaning Configuration</h3>\r\n              <button\r\n                onClick={fetchAvailableBatches}\r\n                className=\"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700\"\r\n              >\r\n                Load Available Batches\r\n              </button>\r\n            </div>\r\n            \r\n            <div className=\"bg-green-50 p-4 rounded-lg\">\r\n              <h4 className=\"font-medium text-green-900 mb-2\">Field Cleaning Process (per batch)</h4>\r\n              <ul className=\"text-green-700 text-sm space-y-1\">\r\n                <li>• <strong>Drop unnecessary fields:</strong> Keep only essential fields for processing</li>\r\n                <li>• <strong>Bring common fields up:</strong> Move fields common across all sections to statute level</li>\r\n                <li>• <strong>Clean single-section statutes:</strong> Handle single-section statutes specially</li>\r\n                <li>• <strong>Remove preamble duplicates:</strong> Remove duplicate preamble sections</li>\r\n                <li>• <strong>Sort sections:</strong> Preamble first, then numeric, then text</li>\r\n                <li>• <strong>Validate Pakistan law:</strong> Drop non-Pakistan laws using CLI logic</li>\r\n              </ul>\r\n            </div>\r\n\r\n            {/* Cleaning Options */}\r\n            <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n              <h4 className=\"font-medium text-gray-900 mb-3\">Cleaning Options</h4>\r\n              \r\n              <div className=\"space-y-3\">\r\n                <label className=\"flex items-center\">\r\n                  <input\r\n                    type=\"radio\"\r\n                    name=\"cleaningMode\"\r\n                    checked={cleanAllBatches}\r\n                    onChange={() => setCleanAllBatches(true)}\r\n                    className=\"mr-2\"\r\n                  />\r\n                  <span className=\"font-medium\">Clean All Batches</span>\r\n                </label>\r\n                \r\n                <label className=\"flex items-center\">\r\n                  <input\r\n                    type=\"radio\"\r\n                    name=\"cleaningMode\"\r\n                    checked={!cleanAllBatches}\r\n                    onChange={() => setCleanAllBatches(false)}\r\n                    className=\"mr-2\"\r\n                  />\r\n                  <span className=\"font-medium\">Clean Selected Batches</span>\r\n                </label>\r\n              </div>\r\n\r\n              {/* Batch Selection */}\r\n              {!cleanAllBatches && availableBatches && (\r\n                <div className=\"mt-4\">\r\n                  <h5 className=\"font-medium text-gray-700 mb-2\">Select Batches to Clean:</h5>\r\n                  <div className=\"grid grid-cols-3 gap-2 max-h-48 overflow-y-auto\">\r\n                    {availableBatches.batches.map((batch: any) => (\r\n                      <label key={batch.batch_number} className=\"flex items-center space-x-2 text-sm\">\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={selectedBatches.includes(batch.batch_number)}\r\n                          onChange={() => toggleBatchSelection(batch.batch_number)}\r\n                          className=\"rounded\"\r\n                        />\r\n                        <span className={batch.is_cleaned ? \"text-green-600\" : \"text-gray-700\"}>\r\n                          {batch.batch_name} ({batch.document_count} docs)\r\n                          {batch.is_cleaned && <span className=\"text-xs\"> ✓</span>}\r\n                        </span>\r\n                      </label>\r\n                    ))}\r\n                  </div>\r\n                  <p className=\"text-xs text-gray-500 mt-2\">\r\n                    Selected: {selectedBatches.length} batches. Green items are already cleaned.\r\n                  </p>\r\n                </div>\r\n              )}\r\n            </div>\r\n            \r\n            <div className=\"flex space-x-4\">\r\n              <button\r\n                onClick={startBatchCleaning}\r\n                disabled={isProcessing || !!prefixError || (!cleanAllBatches && selectedBatches.length === 0)}\r\n                className=\"bg-green-600 text-white px-6 py-2 rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n              >\r\n                {isProcessing ? 'Processing...' : \r\n                  cleanAllBatches ? 'Clean All Batches' : `Clean ${selectedBatches.length} Selected Batches`}\r\n              </button>\r\n              <button\r\n                onClick={generateMetadata}\r\n                className=\"bg-purple-600 text-white px-6 py-2 rounded-md hover:bg-purple-700\"\r\n              >\r\n                Generate Metadata\r\n              </button>\r\n              <button\r\n                onClick={refreshStatus}\r\n                className=\"bg-gray-600 text-white px-6 py-2 rounded-md hover:bg-gray-700\"\r\n              >\r\n                Refresh Status\r\n              </button>\r\n              <button\r\n                onClick={async () => {\r\n                  try {\r\n                    setIsProcessing(true);\r\n                    const response = await fetch('/api/v1/phase3/batch-diagnostics', {\r\n                      method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(config)\r\n                    });\r\n                    if (response.ok) {\r\n                      const data = await response.json();\r\n                      setDiagnostics(data.batches || []);\r\n                    } else {\r\n                      const err = await response.json();\r\n                      alert('Diagnostics failed: ' + (err.detail || err.message));\r\n                    }\r\n                  } catch (e) {\r\n                    console.error('Diagnostics error', e);\r\n                    alert('Diagnostics failed');\r\n                  } finally {\r\n                    setIsProcessing(false);\r\n                  }\r\n                }}\r\n                className=\"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700\"\r\n              >\r\n                Run Diagnostics\r\n              </button>\r\n            </div>\r\n            {diagnostics && diagnostics.length > 0 && (\r\n              <div className=\"mt-4 bg-white p-3 rounded border text-sm\">\r\n                <h4 className=\"font-medium mb-2\">Batch Diagnostics</h4>\r\n                {diagnostics.map((d: any) => (\r\n                  <div key={d.batch_name} className=\"mb-2\">\r\n                    <strong>{d.batch_name}</strong>: total={d.total_documents}, legacy_cleaned={d.legacy_cleaned_count}, modern_cleaned={d.modern_cleaned_count}, any_cleaned={d.any_cleaned_count}\r\n                    <div className=\"text-xs text-gray-600 mt-1\">legacy sample ids: {d.legacy_samples.join(', ') || 'none'}</div>\r\n                    <div className=\"text-xs text-gray-600\">modern sample ids: {d.modern_samples.join(', ') || 'none'}</div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n        {/* Pakistan Law Validation Tab */}\r\n        {activeTab === 'pakistan-law-validation' && (\r\n        <div className=\"space-y-4\">\r\n          <div className=\"flex items-center justify-between mb-2\">\r\n            <div className=\"flex items-center\">\r\n              <label className=\"flex items-center mr-4\">\r\n                <input type=\"checkbox\" checked={dryRun} onChange={e => setDryRun(e.target.checked)} className=\"mr-2\" />\r\n                <span className=\"font-medium\">Dry Run (Preview Only)</span>\r\n              </label>\r\n              <span className=\"text-xs text-gray-500\">Preview which statutes will be dropped before actual deletion.</span>\r\n            </div>\r\n              <div className=\"flex items-center\">\r\n              <label className=\"flex items-center mr-4\">\r\n                <input type=\"checkbox\" checked={saveMetadata} onChange={e => setSaveMetadata(e.target.checked)} className=\"mr-2\" />\r\n                <span className=\"font-medium text-sm\">Generate Metadata</span>\r\n              </label>\r\n              <span className=\"text-xs text-gray-500\">Save validation statistics and analysis.</span>\r\n            </div>\r\n          </div>\r\n          {validationResults && (\r\n            <div className=\"bg-gray-50 p-4 rounded-lg mt-4\">\r\n              <div className=\"flex justify-between items-center mb-2\">\r\n                <h4 className=\"font-medium text-gray-900\">Validation Results</h4>\r\n                {validationResults.metadata_file && (\r\n                  <span className=\"text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded\">\r\n                    📁 Metadata: {validationResults.metadata_file}\r\n                  </span>\r\n                )}\r\n              </div>\r\n              <div className=\"mb-2 text-sm\">\r\n                <strong>Scanned:</strong> {validationResults.total_scanned} &nbsp;\r\n                <strong>Dropped:</strong> {validationResults.total_dropped} &nbsp;\r\n                <strong>Kept:</strong> {validationResults.total_kept} &nbsp;\r\n                <strong>Batches:</strong> {validationResults.processed_batches}\r\n              </div>\r\n              {validationResults.metadata && (\r\n                <div className=\"mb-2 text-xs bg-white p-2 rounded border\">\r\n                  <strong>Drop Analysis:</strong>\r\n                  <div className=\"grid grid-cols-2 gap-2 mt-1\">\r\n                    <div>Drop Rate: {validationResults.metadata.validation_results?.drop_rate?.toFixed(1)}%</div>\r\n                    <div>Keep Rate: {validationResults.metadata.validation_results?.keep_rate?.toFixed(1)}%</div>\r\n                  </div>\r\n                  {validationResults.metadata.drop_reason_analysis?.top_drop_reasons && (\r\n                    <div className=\"mt-1\">\r\n                      <strong>Top Reasons:</strong> {validationResults.metadata.drop_reason_analysis.top_drop_reasons.map(([reason, count]: [string, number]) => `${reason} (${count})`).join(', ')}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )}\r\n              {validationResults.dropped_docs.length > 0 && (\r\n                <div className=\"mb-2\">\r\n                  <strong>Dropped Statutes:</strong>\r\n                  <ul className=\"list-disc ml-6 text-xs\">\r\n                    {validationResults.dropped_docs.map((doc: any, idx: number) => (\r\n                      <li key={doc.name + idx}>\r\n                        {doc.name}\r\n                        <span className=\"text-red-600\"> ({doc.reason})</span>\r\n                        <span className=\"text-gray-500\"> [{doc.batch}]</span>\r\n                      </li>\r\n                    ))}\r\n                  </ul>\r\n                </div>\r\n              )}\r\n              {validationResults.kept_docs.length > 0 && (\r\n                <div className=\"mb-2\">\r\n                  <strong>Kept Statutes:</strong>\r\n                  <ul className=\"list-disc ml-6 text-xs\">\r\n                    {validationResults.kept_docs.map((doc: any, idx: number) => (\r\n                      <li key={doc.name + idx}>\r\n                        {doc.name}\r\n                        <span className=\"text-green-600\"> [Kept]</span>\r\n                        <span className=\"text-gray-500\"> [{doc.batch}]</span>\r\n                      </li>\r\n                    ))}\r\n                  </ul>\r\n                </div>\r\n              )}\r\n              <div className=\"text-xs text-gray-500\">{validationResults.dry_run ? \"No changes made (preview only)\" : \"Non-Pakistan statutes have been dropped.\"}</div>\r\n            </div>\r\n          )}\r\n            <div className=\"flex items-center justify-between\">\r\n              <h3 className=\"text-lg font-semibold text-gray-900\">Pakistan Law Validation Configuration</h3>\r\n              <button\r\n                onClick={fetchAvailableBatches}\r\n                className=\"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700\"\r\n              >Load Available Batches</button>\r\n            </div>\r\n            <div className=\"bg-yellow-50 p-4 rounded-lg\">\r\n              <ul className=\"text-yellow-700 text-sm space-y-1\">\r\n                <li>• Drop non-Pakistan laws using CLI logic</li>\r\n                <li>• Validate all or selected batches</li>\r\n              </ul>\r\n            </div>\r\n            <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n              <div className=\"space-y-3\">\r\n                <label className=\"flex items-center\"><input type=\"radio\" checked={cleanAllBatches} onChange={() => setCleanAllBatches(true)} className=\"mr-2\"/>Validate All</label>\r\n                <label className=\"flex items-center\"><input type=\"radio\" checked={!cleanAllBatches} onChange={() => setCleanAllBatches(false)} className=\"mr-2\"/>Validate Selected</label>\r\n              </div>\r\n              {/* Show guidance when batches not loaded */}\r\n              {availableBatches === null && (\r\n                <div className=\"text-center py-4 text-gray-500\">\r\n                  Click \"Load Available Batches\" to load batches for validation\r\n                </div>\r\n              )}\r\n              {/* Batch Selection */}\r\n              {/* Batch Selection */}\r\n              {!cleanAllBatches && availableBatches && availableBatches.batches.length > 0 && (\r\n                <div className=\"mt-4 grid grid-cols-3 gap-2 max-h-48 overflow-y-auto\">\r\n                  {availableBatches.batches.map((b: any) => (\r\n                    <label key={b.batch_number} className=\"flex items-center space-x-2 text-sm\">\r\n                      <input type=\"checkbox\" checked={selectedBatches.includes(b.batch_number)} onChange={() => toggleBatchSelection(b.batch_number)} className=\"rounded\"/>\r\n                      <span className={b.is_cleaned ? 'text-green-600' : 'text-gray-700'}>{b.batch_name} ({b.document_count})</span>\r\n                    </label>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n            {/* No batches fallback */}\r\n            {availableBatches && availableBatches.batches.length === 0 && (\r\n              <div className=\"text-center py-4 text-gray-500\">\r\n                No batch collections found. Run section splitting first to create batches.\r\n              </div>\r\n            )}\r\n            <div className=\"flex space-x-4\">\r\n              <button onClick={startPakistanLawValidation} disabled={isProcessing || !!prefixError || (!cleanAllBatches && selectedBatches.length===0)} className=\"bg-yellow-600 text-white px-6 py-2 rounded-md hover:bg-yellow-700 disabled:opacity-50\">{isProcessing?'Processing...':(cleanAllBatches?'Validate All':'Validate Selected')}</button>\r\n              <button onClick={previewValidationMetadata} disabled={isProcessing || !!prefixError || (!cleanAllBatches && selectedBatches.length===0)} className=\"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50\">Preview Metadata</button>\r\n              <button onClick={refreshStatus} className=\"bg-gray-600 text-white px-6 py-2 rounded-md hover:bg-gray-700\">Refresh Status</button>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {activeTab === 'preview' && (\r\n          <div className=\"space-y-4\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <h3 className=\"text-lg font-semibold text-gray-900\">Batch Preview</h3>\r\n              <button\r\n                onClick={fetchBatchPreview}\r\n                className=\"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700\"\r\n              >\r\n                Load Batch Preview\r\n              </button>\r\n            </div>\r\n            \r\n            {batchPreview ? (\r\n              <div className=\"space-y-4\">\r\n                {batchPreview.batches.length > 0 ? (\r\n                  batchPreview.batches.map((batch: any, index: number) => (\r\n                    <div key={index} className=\"bg-gray-50 p-4 rounded-lg\">\r\n                      <h4 className=\"font-medium text-gray-900 mb-2\">{batch.batch_name}</h4>\r\n                      <div className=\"grid grid-cols-2 gap-4 text-sm mb-3\">\r\n                        <div>\r\n                          <span className=\"font-medium\">Documents:</span> {batch.document_count}\r\n                        </div>\r\n                        <div>\r\n                          <span className=\"font-medium\">Sample Documents:</span> {batch.sample_documents?.length || 0}\r\n                        </div>\r\n                      </div>\r\n                      \r\n                      {batch.sample_documents && batch.sample_documents.length > 0 && (\r\n                        <div className=\"space-y-2\">\r\n                          <div className=\"text-xs text-gray-500 mb-2\">Sample Documents (click to expand):</div>\r\n                          {batch.sample_documents.map((doc: any, docIndex: number) => {\r\n                            const statuteKey = `${batch.batch_name}-${docIndex}`;\r\n                            const isStatuteExpanded = expandedStatutes[statuteKey];\r\n                            \r\n                            return (\r\n                              <div key={docIndex} className=\"bg-white border rounded-lg\">\r\n                                {/* Statute Header */}\r\n                                <div \r\n                                  className=\"p-3 cursor-pointer hover:bg-gray-50 flex items-center justify-between\"\r\n                                  onClick={() => toggleStatuteExpansion(statuteKey)}\r\n                                >\r\n                                  <div className=\"flex-1\">\r\n                                    <div className=\"font-medium text-sm text-gray-900\">\r\n                                      {doc.Statute_Name || 'N/A'}\r\n                                    </div>\r\n                                    <div className=\"text-xs text-gray-500\">\r\n                                      {doc.Sections?.length || 0} sections • Province: {doc.Province || 'N/A'}\r\n                                    </div>\r\n                                  </div>\r\n                                  <div className=\"text-gray-400\">\r\n                                    {isStatuteExpanded ? '▼' : '▶'}\r\n                                  </div>\r\n                                </div>\r\n                                \r\n                                {/* Expanded Sections */}\r\n                                {isStatuteExpanded && doc.section_details && (\r\n                                  <div className=\"border-t border-gray-100\">\r\n                                    {doc.section_details.map((section: any, sectionIndex: number) => {\r\n                                      const sectionKey = `${statuteKey}-section-${sectionIndex}`;\r\n                                      const isSectionExpanded = expandedSections[sectionKey];\r\n                                      \r\n                                      return (\r\n                                        <div key={sectionIndex} className=\"border-b border-gray-50 last:border-b-0\">\r\n                                          {/* Section Header */}\r\n                                          <div \r\n                                            className=\"p-3 pl-6 cursor-pointer hover:bg-gray-25 flex items-center justify-between\"\r\n                                            onClick={() => toggleSectionExpansion(sectionKey)}\r\n                                          >\r\n                                            <div className=\"flex-1\">\r\n                                              <div className=\"font-medium text-sm text-blue-900\">\r\n                                                {section.section_title}\r\n                                              </div>\r\n                                              <div className=\"text-xs text-gray-500 mt-1\">\r\n                                                {section.content_preview}\r\n                                              </div>\r\n                                            </div>\r\n                                            <div className=\"text-gray-400 text-sm\">\r\n                                              {isSectionExpanded ? '▼' : '▶'}\r\n                                            </div>\r\n                                          </div>\r\n                                          \r\n                                          {/* Full Section Content */}\r\n                                          {isSectionExpanded && (\r\n                                            <div className=\"p-3 pl-8 bg-gray-50 border-t border-gray-100\">\r\n                                              <div className=\"text-sm text-gray-800 whitespace-pre-wrap\">\r\n                                                {section.content || 'No content available'}\r\n                                              </div>\r\n                                            </div>\r\n                                          )}\r\n                                        </div>\r\n                                      );\r\n                                    })}\r\n                                  </div>\r\n                                )}\r\n                                \r\n                                {/* Fallback for documents without section_details */}\r\n                                {isStatuteExpanded && !doc.section_details && doc.Sections && (\r\n                                  <div className=\"border-t border-gray-100 p-3\">\r\n                                    <div className=\"text-xs text-gray-500 mb-2\">Basic Section Info:</div>\r\n                                    {doc.Sections.map((section: any, sectionIndex: number) => (\r\n                                      <div key={sectionIndex} className=\"text-xs text-gray-700 mb-1\">\r\n                                        • {section.Section || `Section ${sectionIndex + 1}`}\r\n                                      </div>\r\n                                    ))}\r\n                                  </div>\r\n                                )}\r\n                              </div>\r\n                            );\r\n                          })}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  ))\r\n                ) : (\r\n                  <div className=\"text-center py-8 text-gray-500\">\r\n                    <Layers className=\"h-12 w-12 mx-auto mb-4 text-gray-400\" />\r\n                    <p>No batch collections found</p>\r\n                    <p className=\"text-sm\">Run section splitting first to create batches</p>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            ) : (\r\n              <div className=\"text-center py-8 text-gray-500\">\r\n                <Eye className=\"h-12 w-12 mx-auto mb-4 text-gray-400\" />\r\n                <p>Click \"Load Batch Preview\" to see batch collections</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {activeTab === 'statistics' && (\r\n          <div className=\"space-y-4\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <h3 className=\"text-lg font-semibold text-gray-900\">Processing Statistics</h3>\r\n              <button\r\n                onClick={fetchStatistics}\r\n                className=\"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700\"\r\n              >\r\n                Load Statistics\r\n              </button>\r\n            </div>\r\n            \r\n            {statistics ? (\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                <div className=\"bg-blue-50 p-4 rounded-lg text-center\">\r\n                  <div className=\"text-2xl font-bold text-blue-600\">\r\n                    {statistics.statistics?.source_collection?.count || 0}\r\n                  </div>\r\n                  <div className=\"text-sm text-blue-600\">Source Documents</div>\r\n                  <div className=\"text-xs text-blue-500\">{statistics.statistics?.source_collection?.name}</div>\r\n                  <div className=\"text-xs text-gray-500\">\r\n                    {statistics.statistics?.source_collection?.exists ? '✅ Exists' : '❌ Missing'}\r\n                  </div>\r\n                </div>\r\n                \r\n                <div className=\"bg-green-50 p-4 rounded-lg text-center\">\r\n                  <div className=\"text-2xl font-bold text-green-600\">\r\n                    {statistics.statistics?.target_database?.batch_collections?.length || 0}\r\n                  </div>\r\n                  <div className=\"text-sm text-green-600\">Batch Collections</div>\r\n                  <div className=\"text-xs text-green-500\">{statistics.statistics?.target_database?.name}</div>\r\n                  <div className=\"text-xs text-gray-500\">\r\n                    {statistics.statistics?.target_database?.exists ? '✅ Exists' : '❌ Missing'}\r\n                  </div>\r\n                </div>\r\n                \r\n                {statistics.statistics?.target_database?.batch_collections && (\r\n                  <div className=\"md:col-span-2 bg-purple-50 p-4 rounded-lg\">\r\n                    <h4 className=\"font-medium text-purple-900 mb-2\">Batch Collections</h4>\r\n                    <div className=\"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm\">\r\n                      {statistics.statistics.target_database.batch_collections.map((batch: string, index: number) => (\r\n                        <div key={index} className=\"bg-white p-2 rounded text-center\">\r\n                          <div className=\"font-medium\">{batch}</div>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            ) : (\r\n              <div className=\"text-center py-8 text-gray-500\">\r\n                <Settings className=\"h-12 w-12 mx-auto mb-4 text-gray-400\" />\r\n                <p>No statistics available</p>\r\n                <button\r\n                  onClick={fetchStatistics}\r\n                  className=\"mt-2 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700\"\r\n                >\r\n                  Load Statistics\r\n                </button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {activeTab === 'history' && (\r\n          <div className=\"space-y-4\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <h3 className=\"text-lg font-semibold text-gray-900\">Processing History</h3>\r\n              <button\r\n                onClick={fetchHistory}\r\n                className=\"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700\"\r\n              >\r\n                Refresh History\r\n              </button>\r\n            </div>\r\n            \r\n            {history ? (\r\n              <div className=\"space-y-4\">\r\n                {history.history.length > 0 ? (\r\n                  <div className=\"overflow-x-auto\">\r\n                    <table className=\"min-w-full divide-y divide-gray-200\">\r\n                      <thead className=\"bg-gray-50\">\r\n                        <tr>\r\n                          <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                            Operation\r\n                          </th>\r\n                          <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                            Database\r\n                          </th>\r\n                          <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                            Collection\r\n                          </th>\r\n                          <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                            Date\r\n                          </th>\r\n                          <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                            Processed\r\n                          </th>\r\n                          <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                            Actions\r\n                          </th>\r\n                        </tr>\r\n                      </thead>\r\n                      <tbody className=\"bg-white divide-y divide-gray-200\">\r\n                        {history.history.map((item: any, index: number) => (\r\n                          <tr key={index} className=\"hover:bg-gray-50\">\r\n                            <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">\r\n                              <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${\r\n                                item.operation_type === 'split' \r\n                                  ? 'bg-blue-100 text-blue-800' \r\n                                  : 'bg-green-100 text-green-800'\r\n                              }`}>\r\n                                {item.operation_type === 'split' ? 'Section Splitting' : 'Field Cleaning'}\r\n                              </span>\r\n                            </td>\r\n                            <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\r\n                              {item.database}\r\n                            </td>\r\n                            <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\r\n                              {item.collection}\r\n                            </td>\r\n                            <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\r\n                              {new Date(item.created_at).toLocaleDateString()}\r\n                            </td>\r\n                            <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\r\n                              {item.total_processed} items\r\n                            </td>\r\n                            <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\r\n                              <button\r\n                                onClick={() => window.open(`/api/v1/phase3/history/${item.filename}`, '_blank')}\r\n                                className=\"text-indigo-600 hover:text-indigo-900\"\r\n                              >\r\n                                View Details\r\n                              </button>\r\n                            </td>\r\n                          </tr>\r\n                        ))}\r\n                      </tbody>\r\n                    </table>\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"text-center py-8 text-gray-500\">\r\n                    <History className=\"h-12 w-12 mx-auto mb-4 text-gray-400\" />\r\n                    <p>No processing history found</p>\r\n                    <p className=\"text-sm\">Run section splitting or field cleaning to generate history</p>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            ) : (\r\n              <div className=\"text-center py-8 text-gray-500\">\r\n                <History className=\"h-12 w-12 mx-auto mb-4 text-gray-400\" />\r\n                <p>Click \"Refresh History\" to load processing history</p>\r\n                <div className=\"mt-4 text-xs text-gray-500\">\r\n                  <p>• Section splitting creates batch collections</p>\r\n                  <p>• Field cleaning processes each batch individually</p>\r\n                  <p>• All operations are logged with timestamps</p>\r\n                  <p>• Metadata files contain detailed statistics</p>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n  </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Phase3;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}