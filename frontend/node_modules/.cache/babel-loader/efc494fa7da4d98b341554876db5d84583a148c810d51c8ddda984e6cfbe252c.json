{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect, useCallback } from 'react';\nimport { authService } from '../services/authService';\nexport const useAuth = () => {\n  _s();\n  const [authState, setAuthState] = useState({\n    isAuthenticated: false,\n    user: null,\n    token: localStorage.getItem('token'),\n    isLoading: true\n  });\n  const login = useCallback(async (username, password) => {\n    try {\n      setAuthState(prev => ({\n        ...prev,\n        isLoading: true\n      }));\n      const response = await authService.login(username, password);\n      const {\n        access_token\n      } = response.data;\n      localStorage.setItem('token', access_token);\n\n      // Get user info\n      const userResponse = await authService.getCurrentUser();\n      const user = userResponse.data;\n      setAuthState({\n        isAuthenticated: true,\n        user,\n        token: access_token,\n        isLoading: false\n      });\n      return {\n        success: true\n      };\n    } catch (error) {\n      setAuthState(prev => ({\n        ...prev,\n        isLoading: false\n      }));\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : 'Login failed'\n      };\n    }\n  }, []);\n  const logout = useCallback(async () => {\n    try {\n      // Call logout API if needed\n      await authService.logout();\n    } catch (error) {\n      // Continue with logout even if API call fails\n      console.warn('Logout API call failed:', error);\n    } finally {\n      // Clear local state and storage\n      localStorage.removeItem('token');\n      setAuthState({\n        isAuthenticated: false,\n        user: null,\n        token: null,\n        isLoading: false\n      });\n    }\n  }, []);\n  const checkAuth = useCallback(async () => {\n    const token = localStorage.getItem('token');\n    if (!token) {\n      setAuthState(prev => ({\n        ...prev,\n        isLoading: false\n      }));\n      return;\n    }\n    try {\n      const response = await authService.getCurrentUser();\n      const user = response.data;\n      setAuthState({\n        isAuthenticated: true,\n        user,\n        token,\n        isLoading: false\n      });\n    } catch (error) {\n      // Token is invalid, remove it\n      localStorage.removeItem('token');\n      setAuthState({\n        isAuthenticated: false,\n        user: null,\n        token: null,\n        isLoading: false\n      });\n    }\n  }, []);\n  useEffect(() => {\n    checkAuth();\n  }, [checkAuth]); // Add checkAuth dependency back\n\n  return {\n    ...authState,\n    login,\n    logout,\n    checkAuth\n  };\n};\n_s(useAuth, \"S1Q44Gp7ePrHFWDPcJ77T7s21mg=\");","map":{"version":3,"names":["useState","useEffect","useCallback","authService","useAuth","_s","authState","setAuthState","isAuthenticated","user","token","localStorage","getItem","isLoading","login","username","password","prev","response","access_token","data","setItem","userResponse","getCurrentUser","success","error","Error","message","logout","console","warn","removeItem","checkAuth"],"sources":["D:/DigiFloat/LawChronicle/frontend/src/hooks/useAuth.ts"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\r\nimport { authService } from '../services/authService';\r\n\r\ninterface User {\r\n  user_id: string;\r\n  username: string;\r\n}\r\n\r\ninterface AuthState {\r\n  isAuthenticated: boolean;\r\n  user: User | null;\r\n  token: string | null;\r\n  isLoading: boolean;\r\n}\r\n\r\nexport const useAuth = () => {\r\n  const [authState, setAuthState] = useState<AuthState>({\r\n    isAuthenticated: false,\r\n    user: null,\r\n    token: localStorage.getItem('token'),\r\n    isLoading: true,\r\n  });\r\n\r\n  const login = useCallback(async (username: string, password: string) => {\r\n    try {\r\n      setAuthState(prev => ({ ...prev, isLoading: true }));\r\n      \r\n      const response = await authService.login(username, password);\r\n      const { access_token } = response.data;\r\n      \r\n      localStorage.setItem('token', access_token);\r\n      \r\n      // Get user info\r\n      const userResponse = await authService.getCurrentUser();\r\n      const user = userResponse.data;\r\n      \r\n      setAuthState({\r\n        isAuthenticated: true,\r\n        user,\r\n        token: access_token,\r\n        isLoading: false,\r\n      });\r\n      \r\n      return { success: true };\r\n    } catch (error) {\r\n      setAuthState(prev => ({ ...prev, isLoading: false }));\r\n      return { \r\n        success: false, \r\n        error: error instanceof Error ? error.message : 'Login failed' \r\n      };\r\n    }\r\n  }, []);\r\n\r\n  const logout = useCallback(async () => {\r\n    try {\r\n      // Call logout API if needed\r\n      await authService.logout();\r\n    } catch (error) {\r\n      // Continue with logout even if API call fails\r\n      console.warn('Logout API call failed:', error);\r\n    } finally {\r\n      // Clear local state and storage\r\n      localStorage.removeItem('token');\r\n      setAuthState({\r\n        isAuthenticated: false,\r\n        user: null,\r\n        token: null,\r\n        isLoading: false,\r\n      });\r\n    }\r\n  }, []);\r\n\r\n  const checkAuth = useCallback(async () => {\r\n    const token = localStorage.getItem('token');\r\n    \r\n    if (!token) {\r\n      setAuthState(prev => ({ ...prev, isLoading: false }));\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await authService.getCurrentUser();\r\n      const user = response.data;\r\n      \r\n      setAuthState({\r\n        isAuthenticated: true,\r\n        user,\r\n        token,\r\n        isLoading: false,\r\n      });\r\n    } catch (error) {\r\n      // Token is invalid, remove it\r\n      localStorage.removeItem('token');\r\n      setAuthState({\r\n        isAuthenticated: false,\r\n        user: null,\r\n        token: null,\r\n        isLoading: false,\r\n      });\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    checkAuth();\r\n  }, [checkAuth]); // Add checkAuth dependency back\r\n\r\n  return {\r\n    ...authState,\r\n    login,\r\n    logout,\r\n    checkAuth,\r\n  };\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}